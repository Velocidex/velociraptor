# Autogenerated! Do not edit.
- name: amsi
  description: |
    AMSI is an interface on windows to scan a string for malware. This
    function submits the string to the AMSI system and receives a
    determination if it is malware.
  type: Function
  args:
  - name: string
    type: string
    description: A string to scan
    required: true
- name: appcompatcache
  description: Parses the appcompatcache.
  type: Plugin
  category: windows
- name: array
  description: |
    Create an array with all the args.

    This function accepts arbitrary arguments and creates an array by
    flattening the arguments. For example `array(a=1, b=2)` will return
    `[1, 2]`.

    You can use this to flatten a subquery as well:

    ```sql
    SELECT array(a1={ SELECT User FROM Artifact.Windows.System.Users() }) as Users FROM scope()
    ```

    Will return a single row with Users being an array of names.
  type: Function
  category: basic
- name: artifact_definitions
  description: Dump artifact definitions from the internal repository.
  type: Plugin
  args:
  - name: names
    type: string
    description: Artifact definitions to dump
    repeated: true
  - name: deps
    type: bool
    description: If true includes all dependencies as well.
  - name: sanitize
    type: bool
    description: If true we remove extra metadata.
  category: server
- name: artifact_delete
  description: Deletes an artifact from the global repository.
  type: Function
  args:
  - name: name
    type: string
    description: The Artifact to delete
  category: server
- name: artifact_set
  description: Sets an artifact into the global repository.
  type: Function
  args:
  - name: definition
    type: string
    description: Artifact definition in YAML
  - name: prefix
    type: string
    description: Required name prefix
  category: server
- name: atexit
  description: |
    Install a query to run when the query is unwound. This is used to
    clean up when the query ends.

    For example:

    ```vql
    LET _ <= atexit(query={
      SELECT rm(filename="Foobar.txt") FROM scope()
    })
    ```
  type: Function
  args:
  - name: query
    type: Any
    description: A VQL Query to parse and execute.
    required: true
  - name: env
    type: ordereddict.Dict
    description: A dict of args to insert into the scope.
  - name: timeout
    type: uint64
    description: How long to wait for destructors to run (default 60 seconds).
- name: atoi
  description: Convert a string to an integer.
  type: Function
  args:
  - name: string
    type: Any
    description: A string to convert to int
    required: true
  category: basic
- name: audit
  description: |
    Register as an audit daemon in the kernel.

    On Linux the audit subsystem provides real time information about
    kernel auditable events. This plugin registers as a consumer and
    returns parsed events as rows.

    You should configure the audit subsystem using the `auditctl`
    binary before using this plugin.
  type: Plugin
  category: linux
- name: authenticode
  description: |
    This plugin parses authenticode information from PE files.

    On windows, the plugin will also use the windows API to determine
    if the binary is trusted by the system.
  type: Function
  args:
  - name: accessor
    type: string
    description: The accessor to use.
  - name: filename
    type: string
    description: The filename to parse.
    required: true
  - name: verbose
    type: bool
    description: Set to receive verbose information about all the certs.
  category: windows
- name: base64decode
  description: Decodes a base64 encoded string.
  type: Function
  args:
  - name: string
    type: string
    description: A string to decode
    required: true
  category: basic
- name: base64encode
  description: Encodes a string into base64.
  type: Function
  args:
  - name: string
    type: string
    description: A string to decode
    required: true
  category: basic
- name: basename
  description: |
    Return the basename of the path. For example basename(path="/foo/bar") -> "bar"
  type: Function
  args:
  - name: path
    type: string
    description: Extract directory name of path
    required: true
  - name: sep
    type: string
    description: Separator to use (default /)
  category: basic
- name: cache
  description: |
    Creates a cache object.

    A Cache is a data structure which is used to speed up calculating
    data by keeping it's value in memory. A cache is essentially a key
    value store - when the key is accessed, the function will be
    calculated producing a value. If the key is accessed again, the
    value is returned from the cache without calculating it again.

    For example consider the following:

    ```vql
        LET get_pid_query(Lpid) =
           SELECT Pid, Ppid, Name FROM pslist(pid=Lpid)

        SELECT cache(func=get_pid_query(Lpid=Pid), key=str(str=Pid))
        FROM ....
    ```

    The cache will ensure that get_pid_query() is only called once per
    unique Pid by comparing the key against the internal memory store.
  type: Function
  args:
  - name: func
    type: LazyExpr
    description: A function to evaluate
    required: true
  - name: name
    type: string
    description: The global name of this cache (needed when more than one)
  - name: key
    type: string
    description: Cache key to use.
    required: true
  - name: period
    type: int64
    description: The latest age of the cache.
  category: basic
- name: cancel_flow
  description: |
    Cancels the flow.

    This sends the client an immediate cacnellation message and stops
    the flow. It also removes any outstanding requests for the client
    if there are any.
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  - name: flow_id
    type: string
  category: server
- name: certificates
  description: |
    Collect certificate from the system trust store.

    This plugin uses the Windows APIs to fetch the certificates. You
    migth also want to look at the `Windows.System.RootCAStore`
    artifact.
  type: Plugin
  category: windows
- name: chain
  description: |
    Chain the output of several queries into the same table.

    This plugin takes a number of queries and joins their output into
    the same table.

    You can provide the `async=TRUE` parameter to run the queries in
    parallel. This is needed when queries are event queries that never
    terminate. You can use this property to collect the output from
    multiple event plugins into the same artifact output.

    ### Example

    The following returns the rows from the first query then the rows from
    the second query.

    ```sql
    SELECT * FROM chain(
      a={ SELECT ...},
      b={ SELECT ...},
      async=TRUE)
    ```
  type: Plugin
  category: plugin
- name: client_delete
  description: |
    Delete all information related to a client from the filestore.

    This required the SERVER_ADMIN permission.
  type: Plugin
  args:
  - name: client_id
    type: string
    required: true
  - name: really_do_it
    type: bool
  category: server
- name: client_info
  description: |
    Returns client info (like the fqdn) from the datastore.

    Velociraptor maintains basic information about the client in the
    data store, such as its hostname, OS etc.

    This information is refereshed each time the `Generic.Client.Info`
    artifact is collected from the endpoint so it can be out of
    date. This process is called "interrogation" of the endpoint.

    You can refresh the entire fleet's datastore by schduling a
    `Generic.Client.Info` hunt.
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  category: server
- name: client_metadata
  description: |
    Returns client metadata from the datastore.

    Client metadata is a set of free form key/value data. Artifacts
    may use this metdata or it may simply be used as part of your IR
    processes.
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  category: server
- name: client_set_metadata
  description: |
    Sets client metadata.

    Client metadata is a set of free form key/value data (see
    client_metadata() function).
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  category: server
- name: clients
  description: Retrieve the list of clients.
  type: Plugin
  args:
  - name: search
    type: string
    description: 'Client search string. Can have the following prefixes: ''lable:'',
      ''host:'''
  - name: start
    type: uint64
    description: First client to fetch (0)'
  - name: count
    type: uint64
    description: Maximum number of clients to fetch (1000)'
  - name: client_id
    type: string
  category: server
- name: clock
  description: |
    Generate a timestamp periodically. This is mostly useful for event
    queries.

    This plugin generates events periodically. The periodicity can be
    controlled either via the `period` or the `ms` parameter. Each row
    will be a go [time.Time](https://golang.org/pkg/time/#Time)
    object. You can access its unix epoch time with the Sec column.

    ### Example

    The following will generate an event every 10 seconds.

    ```sql
    SELECT Sec FROM clock(period=10)
    ```

    The `start` parameter can be used to schedule the plugin to start
    at a particular time. This can be an integer (which will be
    interpreted as seconds since the epoch), a string or a time value.
  type: Plugin
  args:
  - name: start
    type: Any
    description: Start at this time.
  - name: period
    type: int64
    description: Wait this many seconds between events.
  - name: ms
    type: int64
    description: Wait this many ms between events.
  category: event
- name: collect
  description: |
    Collect artifacts into a local file.

    This plugin is essentially the same as the `velociraptor artifacts
    collect --output file.zip` command. It will collect the artifacts
    into a zip file.
  type: Plugin
  args:
  - name: artifacts
    type: string
    description: A list of artifacts to collect.
    repeated: true
    required: true
  - name: output
    type: string
    description: A path to write the output file on.
  - name: report
    type: string
    description: A path to write the report on.
  - name: args
    type: Any
    description: Optional parameters.
  - name: password
    type: string
    description: An optional password to encrypt the collection zip.
  - name: format
    type: string
    description: Output format (csv, jsonl).
  - name: artifact_definitions
    type: Any
    description: Optional additional custom artifacts.
  - name: template
    type: string
    description: The name of a template artifact (i.e. one which has report of type
      HTML).
  - name: level
    type: int64
    description: Compression level between 0 (no compression) and 9.
  category: plugin
- name: collect_client
  description: |
    Launch an artifact collection against a client. If the client_id
    is "server" then the collection occurs on the server itself. In
    that case the caller needs the SERVER_ADMIN permission.

    There are two way of specifying how to collect the artifacts. The
    simplest way is to specify the environment string using the `env`
    parameter, and a list of artifacts to collect in the `artifacts`
    parameter.

    In this case all artifacts will receive the the same
    parameters. For example:

    ```vql
    SELECT collect_client(
        client_id='C.11a3013ccaXXXXX',
        artifacts='Windows.KapeFiles.Targets',
        env=dict(Device ='C:', VSSAnalysis='Y', KapeTriage='Y')).request AS Flow
    FROM scope()
    ```

    Sometimes we have a numebr of artifacts that use the same
    parameter name for different purposes. In that case we wish to
    specify precisely which artifact receives which parameter. This
    more complex way of specifying the collection using the `spec`
    parameter:

    ```vql
    SELECT collect_client(
        client_id='C.11a3013ccaXXXXX',
        artifacts='Windows.KapeFiles.Targets',
        spec=dict(`Windows.KapeFiles.Targets`=dict(
            Device ='C:', VSSAnalysis='Y', KapeTriage='Y'))).request AS Flow
    FROM scope()
    ```

    In this case the artifact names are repeated in the spec and the
    artifacts parameter.

    NOTE: When constructing the dictionaries for the spec parameter
    you will often need to specify a field name containing full
    stop. You can escape this using the backticks like the example above.
  type: Function
  args:
  - name: client_id
    type: string
    description: The client id to schedule a collection on
    required: true
  - name: artifacts
    type: string
    description: A list of artifacts to collect
    repeated: true
    required: true
  - name: env
    type: Any
    description: Parameters to apply to the artifact (an alternative to a full spec)
  - name: spec
    type: Any
    description: Parameters to apply to the artifacts
  - name: timeout
    type: uint64
    description: Set query timeout (default 10 min)
  - name: ops_per_sec
    type: float64
    description: Set query ops_per_sec value
  - name: max_rows
    type: uint64
    description: Max number of rows to fetch
  - name: max_bytes
    type: uint64
    description: Max number of bytes to upload
  category: server
- name: column_filter
  description: |
    Select columns from another query using regex.

    Sometimes a query produces a large number of columns or
    unpredictable column names (eg. the read_reg_key() plugin produces
    a column per value name).

    You can use the column_filter() plugin to select a subset of the
    columns to include or exclude from an underlying query. For example:

    ```vql
    SELECT * FROM column_filter(
    query={
       SELECT 1 AS A, 2 AS B, 3 AS AB, 4 AS AA
       FROM scope()
    }, include="A", exclude="B")
    ```

    will include columns with the letter A in their name and remove
    columns with the letter B (so it will have A and AA above).
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: This query will be run to produce the columns.
    required: true
  - name: exclude
    type: string
    description: One of more regular expressions that will exclude columns.
    repeated: true
  - name: include
    type: string
    description: One of more regular expressions that will include columns.
    repeated: true
- name: compress
  description: |
    Compress a file.

    The file is compressed using gzip. You can change the location of
    the output using the output parameter.
  type: Function
  args:
  - name: path
    type: string
    description: A path to compress
    required: true
  - name: output
    type: string
    description: A path to write the output - default is the path with a .gz extension
  category: server
- name: connections
  description: |
    List all active connections

    On windows this uses the API to list active sockets.
  type: Plugin
  category: client
- name: copy
  description: |
    Copy a file.

    The source file can use any accessor - for example one can copy
    the $MFT using the ntfs accessor to a regular file. Another
    example is to extract a file from a zip file using the `zip`
    accessor into a file on disk.

    This function can also be used to create new files with prescribed
    content - for example:

    ```vql
    SELECT copy(filename="Hello world", accessor="data", dest="C:/hi.txt")
    FROM scope()
    ```

    NOTE: Sparse files are padded out
  type: Function
  args:
  - name: filename
    type: string
    description: The file to copy from.
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: dest
    type: string
    description: The destination file to write.
    required: true
  - name: permissions
    type: string
    description: Required permissions (e.g. 'x').
  - name: append
    type: bool
    description: If true we append to the target file otherwise truncate it
  category: basic
- name: count
  description: |
    Counts the items.

    This function is an aggregation function that counts the number of
    times it is evaluated per group by context. It is useful in a
    GROUP BY clause to count the number of items in each group.

    You can also use it in a regular query to produce a row
    count. NOTE: When used in this way it only counts the total number
    of rows that are actually evaluated (i.e. not filtered out) due to
    the lazy evaluation property of VQL columns.

    For a full discussion of aggregate functions see
    https://docs.velociraptor.app/docs/vql/#aggregate-functions
  type: Function
  args:
  - name: items
    type: Any
    description: Not used anymore
  category: basic
- name: create_flow_download
  description: |
    Creates a download pack for the flow.

    This function initiates the download creation process for a
    flow. It is equivalent to the GUI functionality allowing to
    "Download Results" from the Flows Overview page.

    Using the `wait` parameter you can wait for the download to
    complete or just kick it off asynchronously.
  type: Function
  args:
  - name: client_id
    type: string
    description: Client ID to export.
    required: true
  - name: flow_id
    type: string
    description: The flow id to export.
    required: true
  - name: wait
    type: bool
    description: If set we wait for the download to complete before returning.
  - name: type
    type: string
    description: Type of download to create (e.g. 'report') default a full zip file.
  - name: template
    type: string
    description: Report template to use (defaults to Reporting.Default).
  category: server
- name: create_hunt_download
  description: |
    Creates a download pack for a hunt.

    This function initiates the download creation process for a
    hunt. It is equivalent to the GUI functionality allowing to
    "Download Results" from the Hunts Overview page.

    Using the `wait` parameter you can wait for the download to
    complete or just kick it off asynchronously.
  type: Function
  args:
  - name: hunt_id
    type: string
    description: Hunt ID to export.
    required: true
  - name: only_combined
    type: bool
    description: If set we only export combined results.
  - name: wait
    type: bool
    description: If set we wait for the download to complete before returning.
  - name: format
    type: string
    description: Format to export (csv,json) defaults to both.
  - name: base
    type: string
    description: Base filename to write to.
  category: server
- name: dict
  description: |
    Construct a dict from arbitrary keyword args.

    This function creates a dictionary (a key/value map). NOTE: In VQL
    dictionaries always have string keys. Sometimes key names contain
    special characters like dots etc, in that case you can use
    backticks to escape the name. For example:

    ```vql
    SELECT dict(Foo="Bar", `Name.With.Dots`="Baz")
    FROM scope()
    ```
  type: Function
  category: basic
- name: diff
  description: |
    Executes 'query' periodically and emit differences from the last query.

    The `diff()` plugin runs a non-event query periodically and calculates
    the difference between its result set from the last run.

    This can be used to create event queries which watch for changes from
    simpler non-event queries.

    The `key` parameter is the name of the column which is used to
    determine row equivalency.

    {{% notice note %}}

    There is only a single equivalence row specified by the `key`
    parameter, and it must be a string. If you need to watch multiple
    columns you need to create a new column which is the concatenation of
    other columns. For example `format(format="%s%d", args=[Name, Pid])`

    {{% /notice %}}

    ### Example

    The following VQL monitors all removable drives and lists files on
    newly inserted drives, or files that have been added to removable
    drives.

    ```sql
    LET removable_disks = SELECT Name AS Drive, Size
    FROM glob(globs="/*", accessor="file")
    WHERE Data.Description =~ "Removable"

    LET file_listing = SELECT FullPath, Mtime As Modified, Size
    FROM glob(globs=Drive+"\\**", accessor="file") LIMIT 1000

    SELECT * FROM diff(
      query={ SELECT * FROM foreach(row=removable_disks, query=file_listing) },
      key="FullPath",
      period=10)
      WHERE Diff = "added"
    ```
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: Source for cached rows.
    required: true
  - name: key
    type: string
    description: The column to use as key.
    required: true
  - name: period
    type: int64
    description: Number of seconds between evaluation of the query.
  category: event
- name: dirname
  description: |
    Return the directory path.

    For example direname(path="/usr/bin/ls") -> "/usr/bin"

    Related: basename()
  type: Function
  args:
  - name: path
    type: string
    description: Extract directory name of path
    required: true
  - name: sep
    type: string
    description: Separator to use (default /)
  category: basic
- name: dns
  description: |
    Monitor dns queries.

    This plugin opens a raw socket and monitors network traffic for
    DNS questions and answers.

    {{% notice note %}}

    When Velociraptor attempts to open a raw socket, sometimes Windows
    Defender treats that as suspicious behavior and quarantines the
    Velociraptor binary. This can be avoided by signing the binary which
    signals to Windows Defender that the binary is legitimate.

    If you do not intend to build Velociraptor from source, use the
    official signed Velociraptor binaries which should not trigger alerts
    from Windows Defender.

    {{% /notice %}}

    It is generally better to use ETW for DNS monitoring than this
    plugin (see Windows.Events.DNSQueries)
  type: Plugin
  category: windows
- name: elastic_upload
  description: |
    Upload rows to elastic.

    This uses the Elastic bulk upload API to push arbitrary rows to
    elastic. The query specified in `query` will be run and each row
    it emits will be uploaded as a separate event to Elastic.

    You can either specify the elastic index explicitely using the
    `index` parameter or provide an `_index` column in the query
    itself to send the row to a different index each time.
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: Source for rows to upload.
    required: true
  - name: threads
    type: int64
    description: How many threads to use.
  - name: index
    type: string
    description: The name of the index to upload to. If not specified ensure a column
      is named '_index'.
  - name: type
    type: string
    description: The type of the index to upload to.
    required: true
  - name: chunk_size
    type: int64
    description: The number of rows to send at the time.
  - name: addresses
    type: string
    description: A list of Elasticsearch nodes to use.
    repeated: true
  - name: username
    type: string
    description: Username for HTTP Basic Authentication.
  - name: password
    type: string
    description: Password for HTTP Basic Authentication.
  - name: cloud_id
    type: string
    description: Endpoint for the Elastic Service (https://elastic.co/cloud).
  - name: api_key
    type: string
    description: Base64-encoded token for authorization; if set, overrides username
      and password.
  - name: wait_time
    type: int64
    description: Batch elastic upload this long (2 sec).
  - name: pipeline
    type: string
    description: Pipeline for uploads
  category: server
- name: encode
  description: Encodes a string as as different type. Currently supported types include
    'hex', 'base64'.
  type: Function
  args:
  - name: string
    type: Any
    required: true
  - name: type
    type: string
    required: true
  category: basic
- name: enumerate
  description: |
    Collect all the items in each group by bin.

    This is an aggregate function that keeps track of all elements in
    a GROUP BY group.

    NOTE: Use this function carefully as memory use can be large. It
    keeps a copy of every element in the group and that can be very
    large for large result sets.
  type: Function
  args:
  - name: items
    type: Any
    description: Not used anymore
  category: basic
- name: enumerate_flow
  description: |
    Enumerate all the files that make up a flow.

    This includes the uploaded files, the result sets and the various
    metadata files that result flow state information.

    This plugin is mostly used for archiving or deleting a flow from
    the filestore.
  type: Plugin
  args:
  - name: client_id
    type: string
    required: true
  - name: flow_id
    type: string
  category: server
- name: environ
  description: |
    Get an environment variable.
  type: Function
  args:
  - name: var
    type: string
    description: Extract the var from the environment.
    required: true
  category: basic
- name: environ
  description: |
    The row returned will have all environment variables as
    columns. If the var parameter is provided, only those variables
    will be provided.
  type: Plugin
  args:
  - name: vars
    type: string
    description: Extract these variables from the environment and return them one
      per row
    repeated: true
  category: plugin
- name: execve
  description: |
    This plugin launches an external command and captures its STDERR,
    STDOUT and return code. The command's stdout is split using the `sep`
    parameter as required.

    This plugin is mostly useful for running arbitrary code on the
    client. If you do not want to allow arbitrary code to run, you can
    disable this by setting the `prevent_execve` flag in the client's
    config file. Be aware than many artifacts require running external
    commands to collect their output though.

    We do not actually transfer the external program to the system
    automatically. If you need to run programs which are not usually
    installed (e.g. Sysinternal's autoruns.exe) you will need to use
    Velociraptor's external tools feature to deliver and manage the
    tools on the client.

    https://docs.velociraptor.app/docs/extending_vql/#using-external-tools
  type: Plugin
  args:
  - name: argv
    type: string
    description: Argv to run the command with.
    repeated: true
    required: true
  - name: sep
    type: string
    description: The serparator that will be used to split the stdout into rows.
  - name: length
    type: int64
    description: Size of buffer to capture output per row.
  category: plugin
- name: expand
  description: |
    Expand the path using the environment.

    This function expands environment variables into the path. It is
    normally needed after using registry values of type REG_EXPAND_SZ as
    they typically contain environment strings. Velociraptor does not
    automatically expand such values since environment variables typically
    depend on the specific user account which reads the registry value
    (different user accounts can have different environment variables).

    This function uses the Golang standard for expanding variables
    (using $varname ). On Windows, we also support using the Windows
    notation with % before and after the variable name.

    ```vql
    SELECT expand(path="My Username is %USERNAME%")
    FROM scope()
    ```

    NOTE: The environment strings are set per user and Velociraptor's
    own environment may not reflect any other process's
    environment. See `Windows.Forensics.ProcessInfo` for a
    forensically sound manner of obtaining the environment from any
    process.
  type: Function
  args:
  - name: path
    type: string
    description: A path with environment escapes
    required: true
  category: basic
- name: favorites_save
  description: |
    Save a collection into the favorites.

    Velociraptor allows the user to save a collection into their
    "Favorite" list. This allows them to quickly and easily pick a
    previously used collection.

    This VQL function provides an interface for this functionality.

    NOTE: A favorite belongs to the calling user - this function will
    update the favorite for the calling user only.
  type: Function
  args:
  - name: name
    type: string
    description: A name for this collection template.
    required: true
  - name: description
    type: string
    description: A description for the template.
  - name: specs
    type: LazyExpr
    description: The collection request spec that will be saved. We use this to create
      the new collection.
    required: true
  - name: type
    type: string
    description: The type of favorite.
    required: true
  category: server
- name: fifo
  description: |
    Executes 'query' and cache a number of rows from it. For each invocation
    we present the set of past rows.

    The `fifo()` plugin allows for VQL queries to apply across historical
    data. The fifo plugin accepts another event query as parameter, then
    retains the last `max_rows` rows from it in an internal queue. Every
    subsequent evaluation from the query will return the full set of rows
    in the queue. Older rows are expired from the queue according to the
    `max_age` parameter.

    Fifos are usually used to form queries that look for specific pattern
    of behavior. For example, a successful logon followed by failed
    logons. In this case the fifo retains the recent history of failed
    logons in its internal queue, then when a successful logon occurs we
    can check the recent failed ones in its queue.

    ### Example

    The following checks for 5 failed logons followed by a successful
    logon.

    ```sql
    LET failed_logon = SELECT EventData as FailedEventData,
       System as FailedSystem
    FROM watch_evtx(filename=securityLogFile)
    WHERE System.EventID.Value = 4625

    LET last_5_events = SELECT FailedEventData, FailedSystem
        FROM fifo(query=failed_logon,
                  max_rows=500,
                  max_age=atoi(string=failedLogonTimeWindow))

    LET success_logon = SELECT EventData as SuccessEventData,
       System as SuccessSystem
    FROM watch_evtx(filename=securityLogFile)
    WHERE System.EventID.Value = 4624

    SELECT * FROM foreach(
      row=success_logon,
      query={
       SELECT SuccessSystem.TimeCreated.SystemTime AS LogonTime,
              SuccessSystem, SuccessEventData,
              enumerate(items=FailedEventData) as FailedEventData,
              FailedSystem, count(items=SuccessSystem) as Count
       FROM last_5_events
       WHERE FailedEventData.SubjectUserName = SuccessEventData.SubjectUserName
       GROUP BY LogonTime
          })  WHERE Count > atoi(string=failureCount)
    ```
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: Source for cached rows.
    required: true
  - name: max_age
    type: int64
    description: Maximum number of seconds to hold rows in the fifo.
  - name: max_rows
    type: int64
    description: Maximum number of rows to hold in the fifo.
  - name: flush
    type: bool
    description: If specified we flush all rows from cache after the call.
  category: event
- name: file_store
  description: |
    Resolves file store paths into full filesystem paths.

    This function is only available on the server. It can be used to
    find the backing file behind a filestore path so it can be passed
    on to an external program.

    Velociraptor uses the concept of a Virtual File System to manage the
    information about clients etc. The VFS path is a path into the file
    store. Of course ultimately (at least in the current implementation)
    the file store is storing files on disk, but the disk filename is not
    necessarily the same as the VFS path (for example non representable
    characters are escaped).

    You can use the `file_store()` function to return the real file path
    on disk. This probably only makes sense for VQL queries running on the
    server which can independently open the file.

    In future the file store may be abstracted (e.g. files may not be
    locally stored at all) and this function may stop working.
  type: Function
  args:
  - name: path
    type: string
    description: A VFS path to convert
    repeated: true
    required: true
  category: server
- name: file_store_delete
  description: |
    Delete file store paths.
  type: Function
  args:
  - name: path
    type: string
    description: A VFS path to remove
    required: true
  category: server
- name: filesystems
  description: |
    Enumerates mounted filesystems.
  type: Plugin
  category: plugin
- name: filter
  description: |
    Filters a strings array by regex.
  type: Function
  args:
  - name: list
    type: string
    description: A list of items to filter
    repeated: true
    required: true
  - name: regex
    type: string
    description: A regex to test each item
    repeated: true
    required: true
  category: basic
- name: flatten
  description: Flatten the columns in query. If any column repeats then we repeat
    the entire row once for each item.
  type: Plugin
  args:
  - name: Name
    type: string
  category: plugin
- name: flow_results
  description: |
    Retrieve the results of a flow.

    This is similar to the source() plugin.

    NOTE: Since a collection can collect multiple artifacts you must
    specify the artifact you are interested in.
  type: Plugin
  args:
  - name: artifact
    type: string
    description: The artifact to retrieve
  - name: source
    type: string
    description: An optional source within the artifact.
  - name: flow_id
    type: string
    description: The hunt id to read.
    required: true
  - name: client_id
    type: string
    description: The client id to extract
    required: true
  category: server
- name: flows
  description: |
    Retrieve the flows launched on each client.

    Each flow record will include the creator of the flow, the request
    and metadata about the collection.
  type: Plugin
  args:
  - name: client_id
    type: string
    required: true
  - name: flow_id
    type: string
  category: server
- name: for
  description: |
    Iterate over a list.

    DEPRECATED - use foreach() instead.
  type: Plugin
  args:
  - name: var
    type: string
    description: The variable to assign.
    required: true
  - name: foreach
    type: StoredQuery
    description: The variable to iterate over.
    required: true
  - name: query
    type: StoredQuery
    description: Run this query over the item.
  category: plugin
- name: foreach
  description: |
    Executes 'query' once for each row in the 'row' query.

    The columns in row will be stored in the scope that is used to
    evaluate the query therefore the query may refer to the results
    from the `row` query.

    Foreach in VQL is essentially the same as an SQL JOIN operator but
    much simpler to use.

    If the `workers` parameter is specified, the plugin will spawn
    this many workers and evaluate the `query` query in each worker
    concurrently if possible. It is safe to use a large number here
    (say 100) to utilize all available cores.
  type: Plugin
  args:
  - name: row
    type: LazyExpr
    description: A query or slice which generates rows.
    required: true
  - name: query
    type: StoredQuery
    description: Run this query for each row.
  - name: async
    type: bool
    description: If set we run all queries asyncronously (implies workers=1000).
  - name: workers
    type: int64
    description: Total number of asyncronous workers.
  - name: column
    type: string
    description: If set we only extract the column from row.
  category: plugin
- name: format
  description: |
    Format one or more items according to a format string.

    This function is essentially a wrapper around Golang's
    fmt.Sprintf() function and uses the same format specifiers.

    https://pkg.go.dev/fmt

    Of note the following are very useful:

    * The `% x` applied on strings will hex print the string
    * The `%T` will reveal the internal type of an object.
    * The `%v` is the general purpose stringifier and can apply to strings, ints etc.
  type: Function
  args:
  - name: format
    type: string
    description: Format string to use
    required: true
  - name: args
    type: Any
    description: An array of elements to apply into the format string.
  category: basic
- name: gcs_pubsub_publish
  description: Publish a message to Google PubSub.
  type: Function
  args:
  - name: topic
    type: string
    description: The topic to publish to
    required: true
  - name: project_id
    type: string
    description: The project id to publish to
    required: true
  - name: msg
    type: Any
    description: Message to publish to Pubsub
    required: true
  - name: credentials
    type: string
    description: The credentials to use
    required: true
- name: geoip
  description: |
    Lookup an IP Address using the MaxMind GeoIP database. You can get
    a copy of the database from https://www.maxmind.com/. The database
    must be locally accessible so this probably only makes sense on
    the server.
  type: Function
  args:
  - name: ip
    type: string
    description: IP Address to lookup.
    required: true
  - name: db
    type: string
    description: Path to the MaxMind GeoIP Database.
    required: true
- name: get
  description: |
    Gets the member field from item.

    This is useful to index an item from an array. For example:

    ### Example

    ```sql
    select get(item=[dict(foo=3), 2, 3, 4], member='0.foo') AS Foo from scope()

    [
     {
       "Foo": 3
     }
    ]
    ```

    Using the member parameter you can index inside a nested
    dictionary using dots to separate the layers.

    If you need to access a field with dots in its name, you can use
    the field parameter which simply fetches the named field.
  type: Function
  args:
  - name: item
    type: Any
  - name: member
    type: string
  - name: field
    type: Any
  - name: default
    type: Any
  category: basic
- name: get_client_monitoring
  description: |
    Retrieve the current client monitoring state.

    The client monitoring table represent's the server configuration
    of client event queries to deploy.

    This function is designed to allow programmatic manipulation of
    the event query table in conjunction with set_client_monitoring()
    function.

    It is commonly used together with the `patch()` function to patch
    the data structure to add additional event queries.
  type: Function
  category: server
- name: get_server_monitoring
  description: |
    Retrieve the current server monitoring state.

    See `get_client_monitoring()`
  type: Function
  category: server
- name: getpid
  description: |
    Returns the current pid of the Velociraptor process.

    This is typically used to exclude analysis from our own process.
  type: Function
  category: basic
- name: glob
  description: |
    Retrieve files based on a list of glob expressions

    The `glob()` plugin is one of the most used plugins. It applies a glob
    expression in order to search for files by file name. The glob
    expression allows for wildcards, alternatives and character
    classes. Globs support both forward and backslashes as path
    separators. They also support quoting to delimit components.

    A glob expression consists of a sequence of components separated by
    path separators. If a separator is included within a component it is
    possible to quote the component to keep it together. For example, the
    windows registry contains keys with forward slash in their
    names. Therefore we may use these to prevent the glob from getting
    confused:

    ```
    HKEY_LOCAL_MACHINE\Microsoft\Windows\"Some Key With http://www.microsoft.com/"\Some Value
    ```

    Glob expressions are case insensitive and may contain the following wild cards:

    * The `*` matches one or more characters.
    * The `?` matches a single character.
    * Alternatives are denoted by braces and comma delimited: `{a,b}`
    * Recursive search is denoted by a `**`. By default this searches 3 directories deep. If you need to increase it you can add a depth number (e.g. `**10`)

    By default globs do not expand environment variables. If you need to
    expand environment variables use the `expand()` function explicitly:

    ```sql
    glob(globs=expand(string="%SystemRoot%\System32\Winevt\Logs\*"))
    ```

    ### Example

    The following searches the raw NTFS disk for event logs.

    ```sql
    SELECT FullPath FROM glob(
    globs="C:\Windows\System32\Winevt\Logs\*.evtx",
    accessor="ntfs")
    ```

    ### The root parameter

    If the root parameter is specified, we start globbing from this
    directory - i.e. the glob pattern is appended to the root
    parameter.  The `root` parameter is useful if the directory name
    itself may contain glob characters.
  type: Plugin
  args:
  - name: globs
    type: string
    description: One or more glob patterns to apply to the filesystem.
    repeated: true
    required: true
  - name: root
    type: string
    description: The root directory to glob from (default '').
  - name: accessor
    type: string
    description: An accessor to use.
  - name: nosymlink
    type: bool
    description: If set we do not follow symlinks.
  category: plugin
- name: grep
  description: |
    Search a file for keywords.

    DEPRECATED: Use `yara()` instead.
  type: Function
  args:
  - name: path
    type: string
    description: path to open.
    required: true
  - name: accessor
    type: string
    description: An accessor to use.
  - name: keywords
    type: string
    description: Keywords to search for.
    repeated: true
    required: true
  - name: context
    type: int
    description: Extract this many bytes as context around hits.
  category: plugin
- name: grok
  description: |
    Parse a string using a Grok expression.

    This is most useful for parsing syslog style logs (e.g. IIS, Apache logs).

    You can read more about GROK expressions here
    https://www.elastic.co/blog/do-you-grok-grok
  type: Function
  args:
  - name: grok
    type: string
    description: Grok pattern.
    required: true
  - name: data
    type: string
    description: String to parse.
    required: true
  - name: patterns
    type: Any
    description: Additional patterns.
  - name: all_captures
    type: bool
    description: Extract all captures.
  category: parsers
- name: gui_users
  description: |
    Retrieve the list of users on the server.
  type: Plugin
  category: server
- name: handles
  description: |
    Enumerate process handles.
  type: Plugin
  args:
  - name: pid
    type: int64
    description: The PID to dump out.
    required: true
  category: windows
- name: hash
  description: |
    Calculate the hash of a file.

    This function calculates the MD5, SHA1 and SHA256 hashes of the file.
  type: Function
  args:
  - name: path
    type: string
    description: Path to open and hash.
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  category: plugin
- name: http_client
  description: |
    Make a http request.

    This plugin makes a HTTP connection using the specified method. The
    headers and parameters may be specified. The plugin reads the
    specified number of bytes per returned row.

    If `disable_ssl_security` is specified we do not enforce SSL
    integrity. This is required to connect to self signed ssl web
    sites. For example many API handlers are exposed over such
    connections.

    {{% notice note %}}

    When connecting to the Velociraptor frontend itself, even in self
    signed mode, we will ensure certs are properly verified. You can
    therefore safely export files from the Frontend's public directory
    over self signed SSL. When connecting to a self signed Velociraptor
    frontend, we ensure the self signed certificate was issued by the
    Velociraptor internal CA - i.e. we pin the Frontend's certificate in
    the binary.

    {{% /notice %}}

    The `http_client()` plugin allows use to interact with any web
    services. If the web service returns a json blob, we can parse it with
    the `parse_json()` function (or `parse_xml()` for SOAP
    endpoints). Using the parameters with a POST method we may actually
    invoke actions from within VQL (e.g. send an SMS via an SMS gateway
    when a VQL event is received).So this is a very powerful plugin.

    When the `tempfile_extension` parameter is provided, the HTTP
    request body will be written to a tempfile with that
    extension. The name of this tempfile will be emitted as the
    Content column.

    This plugin will emit rows with the following columns:
    * Url      string: The url we fetched.
    * Content  string: The body content for this chunk
    * Response int: The HTTP response code (200=success)

    ### Example

    The following VQL returns the client's external IP as seen by the
    externalip service.

    ```sql
    SELECT Content as IP from http_client(url='http://www.myexternalip.com/raw')
    ```

    You can use this plugin to download file contents by passing the
    `tempfile_extension` parameter. In this case this plugin will
    create a new temp file with the speicfied extension, write the
    content of the HTTP request into it and then emit a row with
    `Content` being the name of the file. The file will be
    automatically removed when the query ends.
  type: Plugin
  args:
  - name: url
    type: string
    description: The URL to fetch
    required: true
  - name: params
    type: Any
    description: Parameters to encode as POST or GET query strings
  - name: headers
    type: Any
    description: A dict of headers to send.
  - name: method
    type: string
    description: HTTP method to use (GET, POST)
  - name: data
    type: string
    description: If specified we write this raw data into a POST request instead of
      encoding the params above.
  - name: chunk_size
    type: int
    description: Read input with this chunk size and send each chunk as a row
  - name: disable_ssl_security
    type: bool
    description: Disable ssl certificate verifications.
  - name: tempfile_extension
    type: string
    description: If specified we write to a tempfile. The content field will contain
      the full path to the tempfile.
  - name: remove_last
    type: bool
    description: If set we delay removal as much as possible.
  category: plugin
- name: humanize
  description: |
    Format items in human readable way.

    Formats a byte count in human readable way (e.g. Mb, Gb etc).
  type: Function
  args:
  - name: bytes
    type: int64
    description: Format bytes with units
  category: basic
- name: hunt
  description: |
    Create and launch a hunt.

    This function will create a new hunt to collect the specified
    artifacts. The artifacts to collect are provided in the
    `artifacts` parameter. Artifact parameters are provided in the
    `spec` parameter (see example below).

    NOTE: In the GUI hunts are always created in the paused
    state. This is not the default state when using this function (all
    hunts are immediately active).

    ```vql
    SELECT hunt(
        description="A general hunt",
        artifacts='Windows.KapeFiles.Targets',
        spec=dict(`Windows.KapeFiles.Targets`=dict(
            Device ='C:', VSSAnalysis='Y', KapeTriage='Y')))
    FROM scope()
    ```
  type: Function
  args:
  - name: description
    type: string
    description: Description of the hunt
    required: true
  - name: artifacts
    type: string
    description: A list of artifacts to collect
    repeated: true
    required: true
  - name: expires
    type: uint64
    description: Number of milliseconds since epoch for expiry
  - name: spec
    type: Any
    description: Parameters to apply to the artifacts
  - name: timeout
    type: uint64
    description: Set query timeout (default 10 min)
  - name: ops_per_sec
    type: float64
    description: Set query ops_per_sec value
  - name: max_rows
    type: uint64
    description: Max number of rows to fetch
  - name: max_bytes
    type: uint64
    description: Max number of bytes to upload
  - name: pause
    type: bool
    description: If specified the new hunt will be in the paused state
  - name: include_labels
    type: string
    description: If specified only include these labels
    repeated: true
  - name: exclude_labels
    type: string
    description: If specified exclude these labels
    repeated: true
  category: server
- name: hunt_add
  description: |
    Assign a client to a hunt.

    This function allows a client to be added to a hunt. The client
    will be immediately scheduled and the results will be added to the
    hunt. Clients are added to a hunt regardless of any hunt
    conditions, or even if the hunt is stopped.

    You can use this function to manually add clients to selected
    hunts for example after being triaged or post processed to
    identify the clients of interest.

    NOTE: An alternative method is to create a hunt that only targets
    a specific label and then just assign the label to specific
    clients.

    ## Adding an existing flow to a hunt.

    If a flow_id is specified, this function will just immediately add
    the collection to the hunt, without scheduling a new
    collection. The results of this flow will be visible when post
    processing the hunt, exporting the hunt etc.

    This is useful to redo a collection in a hunt - for example, if
    some collections in the hunt expired or were cancelled you can
    manually re-run these collections and then when successful re-add
    them to the hunt.
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  - name: hunt_id
    type: string
    required: true
  - name: flow_id
    type: string
    description: If a flow id is specified we do not create a new flow, but instead
      add this flow_id to the hunt.
  category: server
- name: hunt_flows
  description: |
    Retrieve the flows launched by a hunt.

    A Velociraptor hunt is just a collection of related flows. This
    plugin simply enumerates all the flows as part of this hunt.

    You can use this to figure out if all the collections were
    successful by looking at the result of each flow object.
  type: Plugin
  args:
  - name: hunt_id
    type: string
    description: The hunt id to inspect.
    required: true
  - name: start_row
    type: int64
    description: The first row to show (used for paging).
  - name: limit
    type: int64
    description: Number of rows to show (used for paging).
  category: server
- name: hunt_results
  description: |
    Retrieve the results of a hunt.

    This plugin essentially iterates over all flows in the hunt and
    reads out all collected rows for each client in the same table.

    It is equivalent to the source() plugin in the hunt notebook
    context.
  type: Plugin
  args:
  - name: artifact
    type: string
    description: The artifact to retrieve
  - name: source
    type: string
    description: An optional source within the artifact.
  - name: hunt_id
    type: string
    description: The hunt id to read.
    required: true
  - name: brief
    type: bool
    description: If set we return less columns.
  category: server
- name: hunts
  description: |
    Retrieve the list of hunts.
  type: Plugin
  args:
  - name: hunt_id
    type: string
    description: A hunt id to read, if not specified we list all of them.
  category: server
- name: if
  description: |
    Conditional execution of query

    This function evaluates a condition. Note that the values used in the
    `then` or `else` clause are evaluated lazily. They may be expressions
    that involve stored queries (i.e. queries stored using the `LET`
    keyword). These queries will not be evaluated if they are not needed.

    This allows a query to cheaply branch. For example, if a parameter is
    given, then perform hash or upload to the server.
  type: Function
  args:
  - name: condition
    type: Any
    required: true
  - name: then
    type: LazyExpr
  - name: else
    type: LazyExpr
  category: basic
- name: if
  description: |
    Conditional execution of query

    This function evaluates a condition. Note that the values used in the
    `then` or `else` clause are evaluated lazily. They may be expressions
    that involve stored queries (i.e. queries stored using the `LET`
    keyword). These queries will not be evaluated if they are not needed.

    This allows a query to cheaply branch. For example, if a parameter is
    given, then perform hash or upload to the server. See the
    `Windows.Search.FileFinder` for an example of how `if()` is used.
  type: Plugin
  args:
  - name: condition
    type: Any
    required: true
  - name: then
    type: StoredQuery
    required: true
  - name: else
    type: StoredQuery
  category: plugin
- name: import_collection
  description: |
    Imports an offline collection zip file (experimental).

    Offline collectors are preconfigure Velociraptor binaries that
    collect specific artifacts into a zip file.

    This function allows such a collection to be imported into the GUI
    as if it was collected by the server. The collection will be
    loaded into a client's filestore directory.

    Since there is no actual client id associated with the offline
    collection (there is no Velociraptor client running on the
    endpoint) we generate a random client ID for a new client.

    If you specify an existing client id, the collection will be
    uploaded into that client.

    NOTE: Combine this function with the hunt_add() function to add a
    manual offline collection to an ongoing hunt.
  type: Function
  args:
  - name: client_id
    type: string
    description: The client id to import to. Use 'auto' to generate a new client id.
    required: true
  - name: hostname
    type: string
    description: When creating a new client, set this as the hostname.
  - name: filename
    type: string
    description: Path on server to the collector zip.
    required: true
  - name: accessor
    type: string
    description: The accessor to use
- name: info
  description: |
    Get information about the running host.

    This plugin returns a single row with information about the current
    system. The information includes the Hostname, Uptime, OS, Platform
    etc.

    This plugin is very useful in preconditions as it restricts a query to
    certain OS or versions.
  type: Plugin
  category: plugin
- name: int
  description: |
    Truncate to an integer.

    If provided a string, the function will try to parse it into an integer.
  type: Function
  args:
  - name: int
    type: Any
    description: The integer to round
  category: plugin
- name: interfaces
  description: |
    List all active network interfaces using the API.
  type: Plugin
  category: windows
- name: inventory
  description: |
    Retrieve the tools inventory.

    The inventory contains information about all the external tools
    Velociraptor is managing. This plugin will display this.

    See https://docs.velociraptor.app/docs/extending_vql/#using-external-tools
  type: Plugin
  category: server
- name: inventory_add
  description: |
    Add or reconfigure a tool into the inventory.

    Note that if you provide a file to override the tool it must be
    readable by the server (so the file must reside on the server or
    be accessible over a network share).
  type: Function
  args:
  - name: tool
    type: string
    required: true
  - name: serve_locally
    type: bool
  - name: url
    type: string
  - name: hash
    type: string
  - name: filename
    type: string
    description: The name of the file on the endpoint
  - name: file
    type: string
    description: An optional file to upload
  - name: accessor
    type: string
    description: The accessor to use to read the file.
  category: server
- name: inventory_get
  description: Get tool info from inventory service.
  type: Function
  args:
  - name: tool
    type: string
    required: true
  category: server
- name: ip
  description: |
    Format an IP address.

    Converts an ip address encoded in various ways. If the IP address is
    encoded as 32 bit integer we can use netaddr4_le or netaddr4_be to
    print it in a human readable way.

    This currently does not support IPv6 addresses. Those are usually
    encoded as an array of 8 bytes which makes it easy to format using the
    `format()` function:

    ```
      format(format="%x:%x:%x:%x:%x:%x:%x:%x", value)
    ```
  type: Function
  args:
  - name: netaddr4_le
    type: int64
    description: A network order IPv4 address (as little endian).
  - name: netaddr4_be
    type: int64
    description: A network order IPv4 address (as big endian).
  category: plugin
- name: items
  description: |
    Iterate over dict members producing _key and _value columns

    This can be used to filter dict items by feeding the results to
    `to_dict()`
  type: Function
  args:
  - name: item
    type: Any
  category: basic
- name: items
  description: Enumerate all members of the item (similar to Pythons items() method.
  type: Plugin
  args:
  - name: item
    type: Any
    description: The item to enumerate.
  category: basic
- name: join
  description: |
    Join all the args on a separator.

    Joins the array into a string separated by the sep character.
  type: Function
  args:
  - name: array
    type: string
    description: The array to join
    repeated: true
    required: true
  - name: sep
    type: string
    description: The separator
  category: basic
- name: js
  description: Compile and run javascript code.
  type: Function
  args:
  - name: js
    type: string
    description: The body of the javascript code.
    required: true
  - name: key
    type: string
    description: If set use this key to cache the JS VM.
  category: experimental
- name: js_call
  description: Compile and run javascript code.
  type: Function
  args:
  - name: func
    type: string
    description: JS function to call.
    required: true
  - name: args
    type: Any
    description: Positional args for the function.
  - name: key
    type: string
    description: If set use this key to cache the JS VM.
  category: experimental
- name: js_get
  description: Get a variable's value from the JS VM.
  type: Function
  args:
  - name: var
    type: string
    description: The variable to get from the JS VM.
    required: true
  - name: key
    type: string
    description: If set use this key to cache the JS VM.
  category: plugin
- name: js_set
  description: Set a variables value in the JS VM.
  type: Function
  args:
  - name: var
    type: string
    description: The variable to set inside the JS VM.
    required: true
  - name: value
    type: Any
    description: The value to set inside the VM.
    required: true
  - name: key
    type: string
    description: If set use this key to cache the JS VM.
  category: plugin
- name: killkillkill
  description: Kills the client and forces a restart - this is very aggresive!
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  category: basic
- name: label
  description: |
    Add the labels to the client. If op is 'remove' then remove these labels.
  type: Function
  args:
  - name: client_id
    type: string
    description: Client ID to label.
    required: true
  - name: labels
    type: string
    description: A list of labels to apply
    repeated: true
    required: true
  - name: op
    type: string
    description: An operation on the labels (set, check, remove)
  category: server
- name: len
  description: Returns the length of an object.
  type: Function
  args:
  - name: list
    type: Any
    description: A list of items too filter
    required: true
  category: basic
- name: log
  description: Log the message.
  type: Function
  args:
  - name: message
    type: string
    description: Message to log.
    required: true
  category: basic
- name: lookupSID
  description: Get information about the SID.
  type: Function
  args:
  - name: sid
    type: string
    description: 'A SID to lookup using LookupAccountSid '
    required: true
  category: windows
- name: lowcase
  type: Function
  args:
  - name: string
    type: string
    description: A string to lower
    required: true
  category: basic
- name: mail
  description: Send Email to a remote server.
  type: Plugin
  args:
  - name: to
    type: string
    description: Receipient of the mail
    repeated: true
    required: true
  - name: cc
    type: string
    description: A cc for the mail
    repeated: true
  - name: subject
    type: string
    description: The subject.
  - name: body
    type: string
    description: The body of the mail.
    required: true
  - name: period
    type: int64
    description: How long to wait before sending the next mail - help to throttle
      mails.
    required: true
  category: server
- name: max
  description: |
    Finds the largest item in the aggregate.

    It is only meaningful in a group by query.

    ### Example

    The following query lists all the processes and shows the largest
    bash pid of all bash processes.

    ```SQL
    SELECT Name, max(items=Pid) as LargestPid from pslist() Where Name =~ 'bash' group by Name
    ```
  type: Function
  args:
  - name: item
    type: int64
    required: true
  category: basic
- name: memoize
  description: Memoize a query into memory.
  type: Function
  args:
  - name: query
    type: LazyExpr
    description: Query to expand into memory
    required: true
  - name: key
    type: string
    description: The name of the column to use as a key.
    required: true
  - name: period
    type: int64
    description: The latest age of the cache.
  category: basic
- name: min
  description: |
    Finds the smallest item in the aggregate.

    It is only meaningful in a group by query.

    ### Example

    The following query lists all the processes and shows the smallest
    bash pid of all bash processes.

    ```SQL
    SELECT Name, min(items=Pid) as SmallestPid from pslist() Where Name =~ 'bash' group by Name
    ```
  type: Function
  args:
  - name: item
    type: int64
    required: true
  category: basic
- name: mock
  description: Mock a plugin.
  type: Function
  args:
  - name: plugin
    type: string
    description: The plugin to mock
  - name: function
    type: string
    description: The function to mock
  - name: artifact
    type: Any
    description: The artifact to mock
  - name: results
    type: Any
    description: The result to return
    required: true
  category: utils
- name: mock_check
  description: Check expectations on a mock.
  type: Function
  args:
  - name: plugin
    type: string
    description: The plugin to mock
  - name: function
    type: string
    description: The function to mock
  - name: expected_calls
    type: int
    description: How many times plugin should be called
  - name: clear
    type: bool
    description: This call will clear previous mocks for this plugin
  category: utils
- name: modules
  description: Enumerate Loaded DLLs.
  type: Plugin
  args:
  - name: pid
    type: int64
    description: The PID to dump out.
    required: true
  category: windows
- name: monitoring
  description: Extract monitoring log from a client. If client_id is not specified
    we watch the global journal which contains event logs from all clients.
  type: Plugin
  args:
  - name: client_id
    type: string
    description: The client id to extract
  - name: flow_id
    type: string
    description: A flow ID (client or server artifacts)
  - name: hunt_id
    type: string
    description: Retrieve sources from this hunt (combines all results from all clients)
  - name: artifact
    type: string
    description: The name of the artifact collection to fetch
  - name: source
    type: string
    description: An optional named source within the artifact
  - name: start_time
    type: Any
    description: Start return events from this date (for event sources)
  - name: end_time
    type: Any
    description: Stop end events reach this time (event sources).
  - name: notebook_id
    type: string
    description: The notebook to read from (shoud also include cell id)
  - name: notebook_cell_id
    type: string
    description: The notebook cell read from (shoud also include notebook id)
  - name: notebook_cell_table
    type: int64
    description: A notebook cell can have multiple tables.)
  - name: start_row
    type: int64
    description: Start reading the result set from this row
  - name: count
    type: int64
    description: Maximum number of clients to fetch (default unlimited)'
  category: server
- name: netstat
  description: Collect network information.
  type: Plugin
  category: windows
- name: notebook_delete
  description: 'Delete a notebook with all its cells. '
  type: Plugin
  args:
  - name: notebook_id
    type: string
    required: true
  - name: really_do_it
    type: bool
  category: server
- name: now
  description: Returns current time in seconds since epoch.
  type: Function
  args:
  - name: string
    type: Any
    description: A string to convert to int
    required: true
  category: basic
- name: olevba
  description: |
    Extracts VBA Macros from Office documents.

    This plugin parses the provided files as OLE documents in order to
    recover VB macro code. A single document can have multiple code
    objects, and each such code object is emitted as a row.
  type: Plugin
  args:
  - name: file
    type: string
    description: A list of filenames to open as OLE files.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  - name: max_size
    type: int64
    description: Maximum size of file we load into memory.
  category: parsers
- name: parallelize
  description: Runs query on result batches in parallel.
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: The query will be run in parallel over batches.
    required: true
  - name: client_id
    type: string
    description: The client id to extract
  - name: flow_id
    type: string
    description: A flow ID (client or server artifacts)
  - name: hunt_id
    type: string
    description: Retrieve sources from this hunt (combines all results from all clients)
  - name: artifact
    type: string
    description: The name of the artifact collection to fetch
  - name: source
    type: string
    description: An optional named source within the artifact
  - name: start_time
    type: int64
    description: Start return events from this date (for event sources)
  - name: end_time
    type: int64
    description: Stop end events reach this time (event sources).
  - name: notebook_id
    type: string
    description: The notebook to read from (shoud also include cell id)
  - name: notebook_cell_id
    type: string
    description: The notebook cell read from (shoud also include notebook id)
  - name: notebook_cell_table
    type: int64
    description: A notebook cell can have multiple tables.)
  - name: workers
    type: int64
    description: Number of workers to spawn.)
  - name: batch
    type: int64
    description: Number of rows in each batch.)
  category: server
- name: parse_auditd
  description: Parse log files generated by auditd.
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: parse_binary
  description: |
    Parse a binary file into a datastructure using a profile.

    This plugin extract binary data from strings. It works by applying
    a profile to the binary string and generating an object from
    that. Profiles are a json structure describing the binary format. For
    example a profile might be:

    ```json
    [
      ["StructName", 10, [
         ["field1", 2, "unsigned int"],
         ["field2", 6, "unsigned long long"],
       ]]]
    ]
    ```

    The profile is compiled and overlayed on top of the offset specified,
    then the object is emitted with its required fields.

    You can read more about profiles here https://github.com/Velocidex/vtypes
  type: Function
  args:
  - name: filename
    type: string
    description: Binary file to open.
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: profile
    type: string
    description: Profile to use (see https://github.com/Velocidex/vtypes).
  - name: struct
    type: string
    description: Name of the struct in the profile to instantiate.
    required: true
  - name: offset
    type: int64
    description: Start parsing from this offset
  category: parsers
- name: parse_csv
  description: |
    Parses events from a CSV file.

    Parses records from a CSV file. We expect the first row of the CSV
    file to contain column names.  This parser specifically supports
    Velociraptor's own CSV dialect and so it is perfect for post
    processing already existing CSV files.

    The types of each value in each column is deduced based on
    Velociraptor's standard encoding scheme. Therefore types are properly
    preserved when read from the CSV file.

    For example, downloading the results of a hunt in the GUI will produce
    a CSV file containing artifact rows collected from all clients.  We
    can then use the `parse_csv()` plugin to further filter the CSV file,
    or to stack using group by.

    ### Example

    The following stacks the result from a
    `Windows.Applications.Chrome.Extensions` artifact:

    ```sql
    SELECT count(items=User) As TotalUsers, Name
    FROM parse_csv(filename="All Windows.Applications.Chrome.Extensions.csv")
    Order By TotalUsers
    Group By Name
    ```
  type: Plugin
  args:
  - name: filename
    type: string
    description: CSV files to open
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: auto_headers
    type: bool
    description: If unset the first row is headers
  - name: separator
    type: string
    description: Comma separator
  category: parsers
- name: parse_ese
  description: Opens an ESE file and dump a table.
  type: Plugin
  args:
  - name: file
    type: string
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  - name: table
    type: string
    description: A table name to dump
    required: true
  category: parsers
- name: parse_evtx
  description: |
    Parses events from an EVTX file.

    This plugin parses windows events from the Windows Event log files (EVTX).

    A windows event typically contains two columns. The `EventData`
    contains event specific structured data while the `System` column
    contains common data for all events - including the Event ID.

    You should probably almost always filter by one or more event ids
    (using the `System.EventID.Value` field).

    ### Example

    ```sql
    SELECT System.TimeCreated.SystemTime as Timestamp,
           System.EventID.Value as EventID,
           EventData.ImagePath as ImagePath,
           EventData.ServiceName as ServiceName,
           EventData.ServiceType as Type,
           System.Security.UserID as UserSID,
           EventData as _EventData,
           System as _System
    FROM watch_evtx(filename=systemLogFile) WHERE EventID = 7045
    ```
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of event log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  - name: messagedb
    type: string
    description: A Message database from https://github.com/Velocidex/evtx-data.
  category: parsers
- name: parse_float
  description: Convert a string to a float.
  type: Function
  args:
  - name: string
    type: Any
    description: A string to convert to int
    required: true
  category: parsers
- name: parse_json
  description: |
    Parse a JSON string into an object.

    Note that when VQL dereferences fields in a dict it returns a Null for
    those fields that do not exist. Thus there is no error in actually
    accessing missing fields, the column will just return nil.
  type: Function
  args:
  - name: data
    type: string
    description: Json encoded string.
    required: true
  category: parsers
- name: parse_json_array
  description: |
    Parse a JSON string into an array.

    This function is similar to `parse_json()` but works for a JSON list
    instead of an object.
  type: Function
  args:
  - name: data
    type: string
    description: Json encoded string.
    required: true
  category: parsers
- name: parse_json_array
  description: Parses events from a line oriented json file.
  type: Plugin
  args:
  - name: data
    type: string
    description: Json encoded string.
    required: true
  category: parsers
- name: parse_jsonl
  description: Parses a line oriented json file.
  type: Plugin
  args:
  - name: filename
    type: string
    description: JSON file to open
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  category: parsers
- name: parse_lines
  description: Parse a file separated into lines.
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: parse_mft
  description: Scan the $MFT from an NTFS volume.
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of event log files to parse.
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: parse_ntfs
  description: Parse an NTFS image file.
  type: Function
  args:
  - name: device
    type: string
    description: The device file to open. This may be a full path - we will figure
      out the device automatically.
    required: true
  - name: inode
    type: string
    description: The MFT entry to parse in inode notation (5-144-1).
  - name: mft
    type: int64
    description: The MFT entry to parse.
  - name: mft_offset
    type: int64
    description: The offset to the MFT entry to parse.
  category: parsers
- name: parse_ntfs_i30
  description: Scan the $I30 stream from an NTFS MFT entry.
  type: Plugin
  args:
  - name: device
    type: string
    description: The device file to open. This may be a full path - we will figure
      out the device automatically.
    required: true
  - name: inode
    type: string
    description: The MFT entry to parse in inode notation (5-144-1).
  - name: mft
    type: int64
    description: The MFT entry to parse.
  - name: mft_offset
    type: int64
    description: The offset to the MFT entry to parse.
  category: parsers
- name: parse_ntfs_ranges
  description: Show the run ranges for an NTFS stream.
  type: Plugin
  args:
  - name: device
    type: string
    description: The device file to open. This may be a full path - we will figure
      out the device automatically.
    required: true
  - name: inode
    type: string
    description: The MFT entry to parse in inode notation (5-144-1).
  - name: mft
    type: int64
    description: The MFT entry to parse.
  - name: mft_offset
    type: int64
    description: The offset to the MFT entry to parse.
  category: parsers
- name: parse_pe
  description: Parse a PE file.
  type: Function
  args:
  - name: file
    type: string
    description: The PE file to open.
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: parse_pkcs7
  description: Parse a DER encoded pkcs7 string into an object.
  type: Function
  args:
  - name: data
    type: string
    description: PKCS7 DER encoded string.
    required: true
- name: parse_records_with_regex
  description: |
    Parses a file with a set of regexp and yields matches as records.  The
    file is read into a large buffer. Then each regular expression is
    applied to the buffer, and all matches are emitted as rows.

    The regular expressions are specified in the [Go
    syntax](https://golang.org/pkg/regexp/syntax/). They are expected to
    contain capture variables to name the matches extracted.

    For example, consider a HTML file with simple links. The regular
    expression might be:

    ```
    regex='<a.+?href="(?P<Link>[^"]+?)"'
    ```

    To produce rows with a column Link.

    The aim of this plugin is to split the file into records which can be
    further parsed. For example, if the file consists of multiple records,
    this plugin can be used to extract each record, while
    parse_string_with_regex() can be used to further split each record
    into elements. This works better than trying to write a more complex
    regex which tries to capture a lot of details in one pass.


    ### Example

    Here is an example of parsing the /var/lib/dpkg/status files. These
    files consist of records separated by empty lines:

    ```
    Package: ubuntu-advantage-tools
    Status: install ok installed
    Priority: important
    Section: misc
    Installed-Size: 74
    Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
    Architecture: all
    Version: 17
    Conffiles:
     /etc/cron.daily/ubuntu-advantage-tools 36de53e7c2d968f951b11c64be101b91
     /etc/update-motd.d/80-esm 6ffbbf00021b4ea4255cff378c99c898
     /etc/update-motd.d/80-livepatch 1a3172ffaa815d12b58648f117ffb67e
    Description: management tools for Ubuntu Advantage
     Ubuntu Advantage is the professional package of tooling, technology
     and expertise from Canonical, helping organisations around the world
     manage their Ubuntu deployments.
     .
     Subscribers to Ubuntu Advantage will find helpful tools for accessing
     services in this package.
    Homepage: https://buy.ubuntu.com
    ```

    The following query extracts the fields in two passes. The first pass
    uses parse_records_with_regex() to extract records in blocks, while
    using parse_string_with_regex() to further break the block into
    fields.

    ```sql
    SELECT parse_string_with_regex(
       string=Record,
       regex=['Package:\\s(?P<Package>.+)',
         'Installed-Size:\\s(?P<InstalledSize>.+)',
         'Version:\\s(?P<Version>.+)',
         'Source:\\s(?P<Source>.+)',
         'Architecture:\\s(?P<Architecture>.+)']) as Record
       FROM parse_records_with_regex(
         file=linuxDpkgStatus,
         regex='(?sm)^(?P<Record>Package:.+?)\\n\\n')
    ```
  type: Plugin
  args:
  - name: file
    type: string
    description: A list of files to parse.
    repeated: true
    required: true
  - name: regex
    type: string
    description: A list of regex to apply to the file data.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: parse_recyclebin
  description: Parses a $I file found in the $Recycle.Bin
  type: Plugin
  args:
  - name: filename
    type: string
    description: Files to be parsed.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: parse_string_with_regex
  description: Parse a string with a set of regex and extract fields. Returns a dict
    with fields populated from all regex capture variables.
  type: Function
  args:
  - name: string
    type: string
    description: A string to parse.
    required: true
  - name: regex
    type: string
    description: The regex to apply.
    repeated: true
    required: true
  category: parsers
- name: parse_usn
  description: Parse the USN journal from a device.
  type: Plugin
  args:
  - name: device
    type: string
    description: The device file to open.
    required: true
  - name: start_offset
    type: int64
    description: The starting offset of the first USN record to parse.
  category: parsers
- name: parse_x509
  description: Parse a DER encoded x509 string into an object.
  type: Function
  args:
  - name: data
    type: string
    description: X509 DER encoded string.
    required: true
- name: parse_xml
  description: |
    Parse an XML document into a dict like object.
  type: Function
  args:
  - name: file
    type: string
    description: XML file to open.
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  category: parsers
- name: parse_yaml
  description: Parse yaml into an object.
  type: Function
  args:
  - name: filename
    type: string
    description: Yaml Filename
    required: true
  - name: accessor
    type: string
    description: File accessor
- name: partitions
  description: List all partititions
  type: Plugin
  args:
  - name: all
    type: bool
    description: If specified list all Partitions
  category: windows
- name: patch
  description: |
    Patch a JSON object with a json patch or merge.

    The function allows for modifications of objects by way of
    applying a json patch. You can read more about JSON patching here
    https://github.com/evanphx/json-patch.

    I practice you can use this to update server settings - for
    example, consider the client event monitoring state.

    ```text
    SELECT get_client_monitoring() FROM scope()

     [
      {
       "get_client_monitoring": {
        "artifacts": [
         "Generic.Client.Stats"
        ]
       }
      }
     ]
    ```

    Suppose we wish to add a new artifact, we can patch it with the json:
    ```json
    [{"op": "add", "path": "/artifacts/0", "value": "Windows.Events.DNSQueries"}]
    ```

    This can then be immediately pushed to `set_client_monitoring()`
    to update the monitoring state.

    ```
    SELECT set_client_monitoring(value=patch(
           item=get_client_monitoring(),
           patch=[dict(op="add", path="/artifacts/0", value="Windows.Events.DNSQueries")]))
    FROM scope()
    ```
  type: Function
  args:
  - name: item
    type: Any
    description: The item to path
    required: true
  - name: patch
    type: Any
    description: A JSON Patch to apply
  - name: merge
    type: Any
    description: A merge-patch to apply
  category: server
- name: path_join
  description: Build a path by joining all components.
  type: Function
  args:
  - name: components
    type: string
    description: Path components to join.
    repeated: true
    required: true
  - name: sep
    type: string
    description: Separator to use (default /)
  category: basic
- name: path_split
  description: Split a path into components. Note this is more complex than just split()
    because it takes into account path escaping.
  type: Function
  args:
  - name: path
    type: string
    description: Path to split into components.
    required: true
  category: basic
- name: plist
  description: Parse plist file
  type: Function
  args:
  - name: file
    type: string
    description: A list of files to parse.
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: plist
  description: Parses a plist file.
  type: Plugin
  args:
  - name: file
    type: string
    description: A list of files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: prefetch
  description: Parses a prefetch file.
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of event log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: parsers
- name: proc_dump
  description: |
    Dumps process memory.

    Dumps a process into a crashdump. The crashdump file can be opened
    with the windows debugger as normal. The plugin returns the filename
    of the crash dump which is a temporary file - the file will be removed
    when the query completes, so if you want to hold on to it, you should
    use the upload() plugin to upload it to the server or otherwise copy
    it.
  type: Plugin
  args:
  - name: pid
    type: int64
    description: The PID to dump out.
    required: true
  category: windows
- name: proc_yara
  description: |
    Scan processes using yara rules.

    This plugin uses yara's own engine to scan process memory for the signatures.

    {{% notice note %}}

    Process memory access depends on having the [SeDebugPrivilege](https://support.microsoft.com/en-au/help/131065/how-to-obtain-a-handle-to-any-process-with-sedebugprivilege) which depends on how Velociraptor was started. Even when running as System, some processes are not accessible.

    {{% /notice %}}
  type: Plugin
  args:
  - name: rules
    type: string
    description: Yara rules
    required: true
  - name: pid
    type: int
    description: The pid to scan
    required: true
  - name: context
    type: int
    description: Return this many bytes either side of a hit
  - name: key
    type: string
    description: If set use this key to cache the  yara rules.
  category: windows
- name: profile
  description: Returns a profile dump from the running process.
  type: Plugin
  args:
  - name: allocs
    type: bool
    description: A sampling of all past memory allocations
  - name: block
    type: bool
    description: Stack traces that led to blocking on synchronization primitives
  - name: goroutine
    type: bool
    description: Stack traces of all current goroutines
  - name: heap
    type: bool
    description: A sampling of memory allocations of live objects.
  - name: mutex
    type: bool
    description: Stack traces of holders of contended mutexes
  - name: profile
    type: bool
    description: CPU profile.
  - name: trace
    type: bool
    description: CPU trace.
  - name: debug
    type: int64
    description: Debug level
  - name: logs
    type: bool
    description: Recent logs
  - name: queries
    type: bool
    description: Recent Queries run
  - name: metrics
    type: bool
    description: Collect metrics
  - name: duration
    type: int64
    description: Duration of samples (default 30 sec)
  category: plugins
- name: pslist
  description: |
    Enumerate running processes.

    When specifying the pid this operation is much faster so if you are
    interested in specific processes, the pid should be
    specified. Otherwise, the plugin returns all processes one on each
    row.
  type: Plugin
  args:
  - name: pid
    type: int64
    description: A pid to list. If this is provided we are able to operate much faster
      by only opening a single process.
  category: plugin
- name: query
  description: Launch a subquery and materialize it into a list of rows.
  type: Function
  args:
  - name: vql
    type: vfilter.StoredQuery
    required: true
  category: basic
- name: query
  description: Evaluate a VQL query.
  type: Plugin
  args:
  - name: query
    type: string
    description: A VQL Query to parse and execute.
    required: true
  - name: env
    type: ordereddict.Dict
    description: A dict of args to insert into the scope.
- name: rand
  description: Selects a random number.
  type: Function
  args:
  - name: range
    type: int64
    description: Selects a random number up to this range.
  category: basic
- name: range
  description: Iterate over range.
  type: Plugin
  args:
  - name: start
    type: int64
    description: Start index (0 based)
    required: true
  - name: end
    type: int64
    description: End index (0 based)
    required: true
  - name: step
    type: int64
    description: End index (0 based)
    required: true
- name: rate
  description: |
    Calculates the rate (derivative) between two quantities.

    For example if a monitoring plugin returns an absolute value
    sampled in time (e.g. bytes transferred sampled every second) then
    the rate() plugin can calculate the average bytes/sec.

    This function works by remembering the values of x and y from the
    previous row and applying the current rows values.
  type: Function
  args:
  - name: x
    type: float64
    description: The X float
    required: true
  - name: "y"
    type: float64
    description: The Y float
    required: true
  category: server
- name: read_file
  description: Read a file into a string.
  type: Function
  args:
  - name: length
    type: int
    description: Max length of the file to read.
  - name: offset
    type: int64
    description: Where to read from the file.
  - name: filename
    type: string
    description: One or more files to open.
    required: true
  - name: accessor
    type: string
    description: An accessor to use.
  category: basic
- name: read_file
  description: |
    Read files in chunks.

    This plugin reads a file in chunks and returns each chunks as a separate row.

    It is useful when we want to report file contents for small files like
    configuration files etc.

    The returned row contains the following columns: data, offset, filename
  type: Plugin
  args:
  - name: chunk
    type: int
    description: length of each chunk to read from the file.
  - name: max_length
    type: int
    description: Max length of the file to read.
  - name: filenames
    type: string
    description: One or more files to open.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: An accessor to use.
  category: plugin
- name: read_reg_key
  description: |
    This is a convenience plugin which applies the globs to the registry
    accessor to find keys. For each key the plugin then lists all the
    values within it, and returns a row which has the value names as
    columns, while the cells contain the value's stat info (and data
    content available in the `Data` field).

    This makes it easier to access a bunch of related values at once.
  type: Plugin
  args:
  - name: globs
    type: string
    description: Glob expressions to apply.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: windows
- name: reg_rm_key
  description: Removes a key and all its values from the registry.
  type: Function
  args:
  - name: path
    type: string
    description: Registry key path.
    required: true
- name: reg_rm_value
  description: Removes a value in the registry.
  type: Function
  args:
  - name: path
    type: string
    description: Registry value path.
    required: true
- name: reg_set_value
  description: Set a value in the registry.
  type: Function
  args:
  - name: path
    type: string
    description: Registry value path.
    required: true
  - name: value
    type: LazyExpr
    description: Value to set
    required: true
  - name: type
    type: string
    description: Type to set (SZ, DWORD, QWORD)
    required: true
  - name: create
    type: bool
    description: Set to create missing intermediate keys
- name: regex_replace
  description: Search and replace a string with a regexp. Note you can use $1 to replace
    the capture string.
  type: Function
  args:
  - name: source
    type: string
    description: The source string to replace.
    required: true
  - name: replace
    type: string
    description: The substitute string.
    required: true
  - name: re
    type: string
    description: A regex to apply
    required: true
  category: parsers
- name: relpath
  description: Return the relative path of .
  type: Function
  args:
  - name: path
    type: string
    description: Extract directory name of path
    required: true
  - name: base
    type: string
    description: The base of the path
    required: true
  - name: sep
    type: string
    description: Separator to use (default native)
- name: rm
  description: Remove a file from the filesystem using the API.
  type: Function
  args:
  - name: filename
    type: string
    description: Filename to remove.
    required: true
- name: rot13
  description: Apply rot13 deobfuscation to the string.
  type: Function
  args:
  - name: string
    type: string
  category: parsers
- name: sample
  description: |
    Executes 'query' and samples every n'th row.

    This is most useful on the server in order to downsample event
    artifact results.
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: Source query.
    required: true
  - name: "n"
    type: int64
    description: Pick every n row from query.
    required: true
  category: server
- name: scope
  description: return the scope.
  type: Function
  category: basic
- name: scope
  description: |
    The scope plugin returns the current scope as a single row.

    The main use for this plugin is as a NOOP plugin in those cases we
    dont want to actually run anything.

    ### Example

    ```sql
    SELECT 1+1 As Two FROM scop()
    ```
  type: Plugin
  category: plugin
- name: search
  description: Search the server client's index.
  type: Plugin
  args:
  - name: query
    type: string
    description: The query string.
  - name: offset
    type: uint64
    description: Skip this many results.
  - name: limit
    type: uint64
    description: Only return limited results
  - name: type
    type: string
    description: The type of search (e.g. 'key')
  category: server
- name: send_event
  description: |
    Sends an event to a server event monitoring queue.

    This is used to send an event to a waiting server event monitoring
    artifact (either as a VQL query running on the server or perhaps
    an external program waiting for this event via the API.
  type: Function
  args:
  - name: artifact
    type: string
    description: The artifact name to send the event to.
    required: true
  - name: row
    type: ordereddict.Dict
    description: The row to send to the artifact
    required: true
- name: serialize
  description: Encode an object as a string (csv or json).
  type: Function
  args:
  - name: item
    type: Any
    description: The item to encode
    required: true
  - name: format
    type: string
    description: Encoding format (csv,json)
  category: basic
- name: server_metadata
  description: Returns client metadata from the datastore. Client metadata is a set
    of free form key/value data
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  category: server
- name: server_set_metadata
  description: Sets client metadata. Client metadata is a set of free form key/value
    data
  type: Function
  args:
  - name: client_id
    type: string
    required: true
  category: server
- name: set_client_monitoring
  description: Sets the current client monitoring state.
  type: Function
  args:
  - name: value
    type: Any
    description: The Value to set
    required: true
  category: server
- name: set_server_monitoring
  description: Sets the current server monitoring state.
  type: Function
  args:
  - name: value
    type: Any
    description: The Value to set
    required: true
  category: server
- name: sleep
  description: Sleep for the specified number of seconds. Always returns true.
  type: Function
  args:
  - name: time
    type: int64
    description: The number of seconds to sleep
  category: basic
- name: slice
  description: Slice an array.
  type: Function
  args:
  - name: list
    type: Any
    description: A list of items to slice
    required: true
  - name: start
    type: uint64
    description: Start index (0 based)
    required: true
  - name: end
    type: uint64
    description: End index (0 based)
    required: true
- name: source
  description: |
    Retrieve rows from an artifact's source.

    This plugin is mostly useful in reports. It attempts to do the
    right thing automatically by inferring most parameters from its
    execution environment.

    For example when called within a CLIENT report context, it will
    automatically fill its flow id, client id etc. Typically this
    means that you only need to specify the source name (for
    multi-source artifacts).
  type: Plugin
  args:
  - name: client_id
    type: string
    description: The client id to extract
  - name: flow_id
    type: string
    description: A flow ID (client or server artifacts)
  - name: hunt_id
    type: string
    description: Retrieve sources from this hunt (combines all results from all clients)
  - name: artifact
    type: string
    description: The name of the artifact collection to fetch
  - name: source
    type: string
    description: An optional named source within the artifact
  - name: start_time
    type: Any
    description: Start return events from this date (for event sources)
  - name: end_time
    type: Any
    description: Stop end events reach this time (event sources).
  - name: notebook_id
    type: string
    description: The notebook to read from (shoud also include cell id)
  - name: notebook_cell_id
    type: string
    description: The notebook cell read from (shoud also include notebook id)
  - name: notebook_cell_table
    type: int64
    description: A notebook cell can have multiple tables.)
  - name: start_row
    type: int64
    description: Start reading the result set from this row
  - name: count
    type: int64
    description: Maximum number of clients to fetch (default unlimited)'
  category: server
- name: split
  description: Splits a string into an array based on a regexp separator.
  type: Function
  args:
  - name: string
    type: string
    description: The value to split
    required: true
  - name: sep
    type: string
    description: The serparator that will be used to split
    required: true
  category: basic
- name: split_records
  description: Parses files by splitting lines into records.
  type: Plugin
  args:
  - name: filenames
    type: string
    description: Files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: regex
    type: string
    description: The split regular expression (e.g. a comma)
    required: true
  - name: columns
    type: string
    description: If the first row is not the headers, this arg must provide a list
      of column names for each value.
    repeated: true
  - name: first_row_is_headers
    type: bool
    description: A bool indicating if we should get column names from the first row.
  - name: count
    type: int
    description: Only split into this many columns if possible.
  category: parsers
- name: splunk_upload
  description: Upload rows to splunk.
  type: Plugin
  args:
  - name: query
    type: StoredQuery
    description: Source for rows to upload.
    required: true
  - name: threads
    type: int64
    description: How many threads to use.
  - name: url
    type: string
    description: The Splunk Event Collector URL.
  - name: token
    type: string
    description: Splunk HEC Token.
  - name: index
    type: string
    description: The name of the index to upload to.
    required: true
  - name: source
    type: string
    description: The source field for splunk. If not specified this will be 'velociraptor'.
  - name: sourcetype
    type: string
    description: The sourcetype field for splunk. If not specified this will 'vql'
  - name: chunk_size
    type: int64
    description: The number of rows to send at the time.
  - name: skip_verify
    type: bool
    description: 'Skip SSL verification(default: False).'
  - name: wait_time
    type: int64
    description: Batch splunk upload this long (2 sec).
  category: server
- name: sql
  description: Run queries against sqlite, mysql, and postgres databases
  type: Plugin
  args:
  - name: driver
    type: string
    description: sqlite, mysql,or postgres
    required: true
  - name: connstring
    type: string
    description: SQL Connection String
  - name: file
    type: string
    description: Required if using sqlite driver
  - name: accessor
    type: string
    description: The accessor to use if using sqlite
  - name: query
    type: string
    required: true
  - name: args
    type: Any
- name: sqlite
  description: Opens an SQLite file and run a query against it.
  type: Plugin
  args:
  - name: file
    type: string
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  - name: query
    type: string
    required: true
  - name: args
    type: Any
  category: parsers
- name: srum_lookup_id
  description: Lookup a SRUM id.
  type: Function
  args:
  - name: file
    type: string
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  - name: id
    type: int64
    required: true
  category: windows
- name: starl
  description: Compile a starlark code block - returns a module usable in VQL
  type: Function
  args:
  - name: code
    type: string
    description: The body of the starlark code.
    required: true
  - name: key
    type: string
    description: If set use this key to cache the Starlark code block.
  - name: globals
    type: Any
    description: Dictionary of values to feed into Starlark environment
- name: stat
  description: Get file information. Unlike glob() this does not support wildcards.
  type: Plugin
  args:
  - name: filename
    type: string
    description: One or more files to open.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: An accessor to use.
  category: plugin
- name: str
  description: Normalize a String.
  type: Function
  args:
  - name: str
    type: Any
    description: The string to normalize
    required: true
  category: basic
- name: strip
  description: Strip a prefix from a string.
  type: Function
  args:
  - name: string
    type: string
    description: The string to strip
    required: true
  - name: prefix
    type: string
    description: The prefix to strip
  category: basic
- name: substr
  description: Create a substring from a string
  type: Function
  args:
  - name: str
    type: string
    description: The string to shorten
    required: true
  - name: start
    type: int
    description: Beginning index of substring
  - name: end
    type: int
    description: End index of substring
- name: sum
  description: Sums the items.
  type: Function
  args:
  - name: item
    type: int64
    required: true
- name: switch
  description: Executes each query. The first query to return any rows will be emitted.
  type: Plugin
  category: plugin
- name: tempdir
  description: Create a temporary directory. The directory will be removed when the
    query ends.
  type: Function
  args:
  - name: remove_last
    type: bool
    description: If set we delay removal as much as possible.
  category: basic
- name: tempfile
  description: |
    Create a temporary file and write some data into it.

    The file will be automatically removed when the query completes.
  type: Function
  args:
  - name: data
    type: string
    description: Data to write in the tempfile.
    repeated: true
  - name: extension
    type: string
    description: An extension to place in the tempfile.
  - name: permissions
    type: string
    description: Required permissions (e.g. 'x').
  - name: remove_last
    type: bool
    description: If set we delay removal as much as possible.
  category: plugin
- name: timeline
  description: Read a timeline. You can create a timeline with the timeline_add()
    function
  type: Plugin
  args:
  - name: timeline
    type: string
    description: Name of the timeline to read
    required: true
  - name: skip
    type: string
    description: List of child components to skip
    repeated: true
  - name: start
    type: Any
    description: First timestamp to fetch
  - name: notebook_id
    type: string
    description: The notebook ID the timeline is stored in.
- name: timeline_add
  description: Add a new query to a timeline.
  type: Function
  args:
  - name: timeline
    type: string
    description: Supertimeline to add to
    required: true
  - name: name
    type: string
    description: Name of child timeline
    required: true
  - name: query
    type: StoredQuery
    description: Run this query to generate the timeline.
    required: true
  - name: key
    type: string
    description: The column representing the time.
    required: true
  - name: notebook_id
    type: string
    description: The notebook ID the timeline is stored in.
- name: timestamp
  description: Convert from different types to a time.Time.
  type: Function
  args:
  - name: epoch
    type: Any
  - name: cocoatime
    type: int64
  - name: mactime
    type: int64
    description: HFS+
  - name: winfiletime
    type: int64
  - name: string
    type: string
    description: Guess a timestamp from a string
  - name: us_style
    type: bool
    description: US Style Month/Day/Year
  category: basic
- name: to_dict
  description: Construct a dict from another object.
  type: Function
  args:
  - name: item
    type: Any
  category: basic
- name: token
  description: Extract process token.
  type: Function
  args:
  - name: pid
    type: int64
    description: The PID to get the token for.
    required: true
  category: windows
- name: unhex
  description: Apply hex decoding to the string.
  type: Function
  args:
  - name: string
    type: string
    description: Hex string to decode
- name: unzip
  description: Unzips a file into a directory
  type: Plugin
  args:
  - name: filename
    type: string
    description: File to unzip.
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: filename_filter
    type: string
    description: Only extract members matching this filter.
  - name: output_directory
    type: string
    description: Where to unzip to
    required: true
- name: upcase
  type: Function
  args:
  - name: string
    type: string
    description: A string to lower
    required: true
  category: basic
- name: upload
  description: |
    Upload a file to the upload service. For a Velociraptor client this
    will upload the file into the flow and store it in the server's file store.

    If Velociraptor is run locally the file will be copied to the
    `--dump_dir` path or added to the triage evidence container.
  type: Function
  args:
  - name: file
    type: string
    description: The file to upload
    required: true
  - name: name
    type: string
    description: The name of the file that should be stored on the server
  - name: accessor
    type: string
    description: The accessor to use
  - name: mtime
    type: Any
    description: Modified time to record
  - name: atime
    type: Any
    description: Access time to record
  - name: ctime
    type: Any
    description: Change time to record
  - name: btime
    type: Any
    description: Birth time to record
  category: plugin
- name: upload
  description: |
    Upload files to the server.

    This plugin uploads the specified file to the server. If Velociraptor
    is run locally the file will be copied to the `--dump_dir` path or
    added to the triage evidence container.

    This functionality is also available using the upload() function which
    might be somewhat easier to use.
  type: Plugin
  args:
  - name: files
    type: string
    description: A list of files to upload
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: mtime
    type: Any
    description: Modified time to record
  category: plugin
- name: upload_directory
  description: Upload a file to an upload directory. The final filename will be the
    output directory path followed by the filename path.
  type: Function
  args:
  - name: file
    type: string
    description: The file to upload
    required: true
  - name: name
    type: string
    description: Filename to be stored within the output directory
  - name: accessor
    type: string
    description: The accessor to use
  - name: output
    type: string
    description: An output directory to store files in.
    required: true
  - name: mtime
    type: Any
    description: Modified time to set the output file.
  - name: atime
    type: Any
    description: Access time to set the output file.
  - name: ctime
    type: Any
    description: Change time to set the output file.
  - name: btime
    type: Any
    description: Birth time to set the output file.
- name: upload_gcs
  description: Upload files to GCS.
  type: Function
  args:
  - name: file
    type: string
    description: The file to upload
    required: true
  - name: name
    type: string
    description: The name of the file that should be stored on the server
  - name: accessor
    type: string
    description: The accessor to use
  - name: bucket
    type: string
    description: The bucket to upload to
    required: true
  - name: project
    type: string
    description: The project to upload to
    required: true
  - name: credentials
    type: string
    description: The credentials to use
    required: true
  category: plugin
- name: upload_s3
  description: Upload files to S3.
  type: Function
  args:
  - name: file
    type: string
    description: The file to upload
    required: true
  - name: name
    type: string
    description: The name of the file that should be stored on the server
  - name: accessor
    type: string
    description: The accessor to use
  - name: bucket
    type: string
    description: The bucket to upload to
    required: true
  - name: region
    type: string
    description: The region the bucket is in
    required: true
  - name: credentialskey
    type: string
    description: The AWS key credentials to use
    required: true
  - name: credentialssecret
    type: string
    description: The AWS secret credentials to use
    required: true
  - name: endpoint
    type: string
    description: The Endpoint to use
  - name: serversideencryption
    type: string
    description: The server side encryption method to use
  - name: noverifycert
    type: bool
    description: Skip TLS Verification
  category: plugin
- name: upload_sftp
  description: Upload files to SFTP.
  type: Function
  args:
  - name: file
    type: string
    description: The file to upload
    required: true
  - name: name
    type: string
    description: The name of the file that should be stored on the server
  - name: user
    type: string
    description: The username to connect to the endpoint with
    required: true
  - name: path
    type: string
    description: Path on server to upload file to
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: privatekey
    type: string
    description: The private key to use
    required: true
  - name: endpoint
    type: string
    description: The Endpoint to use
    required: true
  - name: hostkey
    type: string
    description: Host key to verify. Blank to disable
  category: basic
- name: upload_webdav
  description: Upload files to a WebDAV server.
  type: Function
  args:
  - name: file
    type: string
    description: The file to upload
    required: true
  - name: name
    type: string
    description: The name that the file should have on the server
  - name: accessor
    type: string
    description: The accessor to use
  - name: url
    type: string
    description: The WebDAV url
    required: true
  - name: basic_auth_user
    type: string
    description: The username to use in HTTP basic auth
  - name: basic_auth_password
    type: string
    description: The password to use in HTTP basic auth
  - name: noverifycert
    type: bool
    description: Skip TLS Verification
  category: basic
- name: uploads
  description: Retrieve information about a flow's uploads.
  type: Plugin
  args:
  - name: client_id
    type: string
    description: The client id to extract
  - name: flow_id
    type: string
    description: A flow ID (client or server artifacts)
  category: server
- name: url
  description: |
    Construct a URL or parse one.

    This function parses or constructs URLs. A URL may be constructed from
    scratch by providing all the components or it may be parsed from an
    existing URL.

    The returned object is a [golang
    URL](https://golang.org/pkg/net/url/#URL) and can be serialized again
    using its `String` method.

    This function is important when constructing parameters for certain
    accessors which receive a URL. For example the `zip` accessor requires
    its file names to consist of URLs. The Zip accessor interprets the URL
    in the following way:

    - The scheme is the delegate accessor to use.
    - The path is the delegate accessor's filename
    - The fragment is used by the zip accessor to retrieve the zip member itself.

    In this case it is critical to properly escape each level - it is not
    possible in the general case to simply append strings. You need to use
    the `url()` function to build the proper url.
  type: Function
  args:
  - name: scheme
    type: string
    description: The scheme to use
  - name: host
    type: string
    description: The host component
  - name: path
    type: string
    description: The path component
  - name: fragment
    type: string
    description: The fragment
  - name: parse
    type: string
    description: A url to parse
  category: basic
- name: user_create
  description: Creates a new user from the server, or updates their permissions or
    reset their password.
  type: Function
  args:
  - name: user
    type: string
    required: true
  - name: roles
    type: string
    repeated: true
    required: true
  - name: password
    type: string
- name: user_delete
  description: Deletes a user from the server.
  type: Function
  args:
  - name: user
    type: string
    required: true
- name: users
  description: Display information about workstation local users. This is obtained
    through the NetUserEnum() API.
  type: Plugin
  category: windows
- name: utf16
  description: Parse input from utf16.
  type: Function
  args:
  - name: string
    type: string
    description: A string to decode
    required: true
  category: basic
- name: utf16_encode
  description: Encode a string to utf16 bytes.
  type: Function
  args:
  - name: string
    type: string
    description: A string to decode
    required: true
  category: basic
- name: uuid
  description: Generate a UUID.
  type: Function
  category: basic
- name: vad
  description: Enumerate process memory regions.
  type: Plugin
  args:
  - name: pid
    type: int64
    description: The PID to dump out.
    required: true
  category: windows
- name: version
  description: |2

    Gets the version of a VQL plugin or function.

    This is useful when writing portable VQL which can work with
    older versions of Velociraptor. When Velociraptor plugins evolve
    in an incompatible way their version is incremented. It is
    possible to cater for multiple versions in the VQL using an if()
    plugin.

    For example the following can chose from a legacy query or a
    modern query based on the plugin version:
    ```
     SELECT * FROM if(
      condition=version(plugin="glob") >= 1,
      then=NewQuery,
      else=LegacyQuery)
    ```
  type: Function
  args:
  - name: function
    type: string
  - name: plugin
    type: string
  category: basic
- name: watch_auditd
  description: Watch log files generated by auditd.
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: event
- name: watch_csv
  description: |
    Watch a CSV file and stream events from it. Note: This is an event
    plugin which does not complete.

    This plugin is the event version of `parse_csv()`. When the CSV file
    grows this plugin will emit the new rows.
  type: Plugin
  args:
  - name: filename
    type: string
    description: CSV files to open
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: auto_headers
    type: bool
    description: If unset the first row is headers
  - name: separator
    type: string
    description: Comma separator
  category: event
- name: watch_etw
  description: Watch for events from an ETW provider.
  type: Plugin
  args:
  - name: name
    type: string
    description: 'A session name '
  - name: guid
    type: string
    description: 'A Provider GUID to watch '
    required: true
  - name: any
    type: uint64
    description: 'Any Keywords '
  - name: all
    type: uint64
    description: 'All Keywords '
  - name: level
    type: int64
    description: Log level (0-5)
  category: event
- name: watch_evtx
  description: |
    Watch an EVTX file and stream events from it.

    This is the Event plugin version of `parse_evtx()`.

    {{% notice note %}}

    It often takes several seconds for events to be flushed to the event
    log and so this plugin's event may be delayed. For some applications
    this results in a race condition with the event itself - for example,
    files mentioned in the event may already be removed by the time the
    event is triggered.

    {{% /notice %}}
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of event log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  - name: messagedb
    type: string
    description: A Message database from https://github.com/Velocidex/evtx-data.
  category: event
- name: watch_monitoring
  description: |
    Watch clients' monitoring log. This is an event plugin. This
    plugin will produce events from all clients.
  type: Plugin
  args:
  - name: artifact
    type: string
    description: The artifact to watch
  category: event
- name: watch_syslog
  description: 'Watch a syslog file and stream events from it. '
  type: Plugin
  args:
  - name: filename
    type: string
    description: A list of log files to parse.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: The accessor to use.
  category: event
- name: watch_usn
  description: Watch the USN journal from a device.
  type: Plugin
  args:
  - name: device
    type: string
    description: The device file to open.
    required: true
  category: event
- name: whoami
  description: Returns the username that is running the query.
  type: Function
- name: winobj
  description: Enumerate The Windows Object Manager namespace.
  type: Plugin
  args:
  - name: path
    type: string
    description: Object namespace path.
  category: windows
- name: wmi
  description: |
    Execute simple WMI queries synchronously.

    This plugin issues a WMI query and returns its rows directly. The
    exact format of the returned row depends on the WMI query issued.

    This plugin creates a bridge between WMI and VQL and it is a very
    commonly used plugin for inspecting the state of windows systems.
  type: Plugin
  args:
  - name: query
    type: string
    description: The WMI query to issue.
    required: true
  - name: namespace
    type: string
    description: The WMI namespace to use (ROOT/CIMV2)
  category: windows
- name: wmi_events
  description: |
    Executes an evented WMI queries asynchronously.

    This plugin sets up a [WMI event](https://docs.microsoft.com/en-us/windows/desktop/wmisdk/receiving-a-wmi-event) listener query.
  type: Plugin
  args:
  - name: query
    type: string
    description: WMI query to run.
    required: true
  - name: namespace
    type: string
    description: WMI namespace
    required: true
  - name: wait
    type: int64
    description: Wait this many seconds for events and then quit.
    required: true
  category: event
- name: write_csv
  description: Write a query into a CSV file.
  type: Plugin
  args:
  - name: filename
    type: string
    description: CSV files to open
    required: true
  - name: accessor
    type: string
    description: The accessor to use
  - name: query
    type: StoredQuery
    description: query to write into the file.
    required: true
  category: plugin
- name: xor
  description: Apply xor to the string and key.
  type: Function
  args:
  - name: string
    type: string
    description: String to apply Xor
    required: true
  - name: key
    type: string
    description: Xor key.
    required: true
- name: yara
  description: |
    Scan files using yara rules.

    The `yara()` plugin applies a signature consisting of multiple rules
    across files. You can read more about [yara rules](https://yara.readthedocs.io/en/v3.4.0/writingrules.html). The
    accessor is used to open the various files which allows this plugin to
    work across raw ntfs, zip members etc.

    Scanning proceeds by reading a block from the file, then applying the
    yara rule on the block. This will fail if the signature is split
    across block boundary. You can choose the block size to be
    appropriate.

    Note that because we are just scanning the file data, yara plugins
    like the pe plugin will not work. You can emulate all the yara plugins
    with VQL anyway (e.g. to test for pe headers)

    Typically the yara rule does not change for the life of the query, so
    we cache it to avoid having to recompile it each time. The `key`
    variable can be used to uniquely identify the cache key for the
    rule. If the `key` variable is not specified, we use the rule text
    itself to generate the cache key. It is recommended that the `key`
    parameter be specified because it makes it more efficient.

    ### Shorthand rules

    This plugin accepts yara rules in the `rules` parameter. But typically
    we only search for keywords so writing a full yara syntax rule is
    tedious. Therefore we provide a shorthand way to specify the
    keywords. For example:

    ```
    wide nocase:foo,bar,baz
    ```

    When the rule is provided in the above form, the plugin will
    automatically generate a yara rule which matches any of the specified
    keywords. The specification before the `:` means the same thing as the
    yara DSL and the following combinations are supported `wide`, `wide
    ascii`, `wide nocase`, `wide nocase ascii`.


    {{% notice note %}}

    By default only the first 100mb of the file are scanned and
    scanning stops after one hit is found.

    {{% /notice %}}
  type: Plugin
  args:
  - name: rules
    type: string
    description: Yara rules in the yara DSL.
    required: true
  - name: files
    type: string
    description: The list of files to scan.
    repeated: true
    required: true
  - name: accessor
    type: string
    description: Accessor (e.g. NTFS)
  - name: context
    type: int
    description: How many bytes to include around each hit
  - name: start
    type: uint64
    description: The start offset to scan
  - name: end
    type: uint64
    description: End scanning at this offset (100mb)
  - name: number
    type: int64
    description: Stop after this many hits (1).
  - name: blocksize
    type: uint64
    description: Blocksize for scanning (1mb).
  - name: key
    type: string
    description: If set use this key to cache the  yara rules.
  category: plugin

