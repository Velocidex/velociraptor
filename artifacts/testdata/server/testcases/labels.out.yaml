SELECT label(client_id=client_id, op='remove', labels=labels), client_id
FROM clients(search='label:*') ORDER BY client_id
[]SELECT * FROM clients(search='label:*') ORDER BY client_id[]SELECT * FROM foreach(
  row={
     SELECT * FROM clients()
     WHERE os_info.system = 'windows' ORDER BY client_id
  }, query={
     SELECT os_info.system, label(
         client_id=client_id, labels=['WinBoxes'],
         op='set')
     FROM scope()
  })
[
 {
  "label(client_id=client_id, labels= ['WinBoxes'], op='set')": {
   "ClientId": "C.abad2ac29511a9ac",
   "Labels": [
    "WinBoxes"
   ],
   "Op": "set"
  },
  "os_info.system": "windows"
 }
]SELECT * FROM clients(search='label:*') ORDER BY client_id[
 {
  "client_id": "C.abad2ac29511a9ac",
  "agent_information": {
   "version": "2019-10-22T10:45:40+10:00",
   "name": "velociraptor"
  },
  "os_info": {
   "system": "windows",
   "release": "Microsoft Windows 10 Enterprise10.0.17763 Build 17763",
   "machine": "amd64",
   "fqdn": "DESKTOP-6CBJ8MJ"
  },
  "last_seen_at": 1571833225742159,
  "last_ip": "192.168.2.129:37468",
  "last_interrogate_flow_id": "F.BMO4ACOTH8U6E",
  "last_ip_class": 1,
  "labels": [
   "WinBoxes"
  ]
 }
]SELECT label(client_id='C.11a3013cca8f826e', op='set', labels=['WinBoxes'], op='check') AS HasLabel FROM scope()[
 {
  "HasLabel": null
 }
]SELECT label(client_id='C.11a3013cca8f826e', op='set', labels=['NoWinBoxes'], op='check') AS HasLabel FROM scope()[
 {
  "HasLabel": null
 }
]SELECT label(client_id=client_id, op='remove', labels=labels), client_id
FROM clients(search='label:*') ORDER BY client_id
[
 {
  "client_id": "C.abad2ac29511a9ac",
  "label(client_id=client_id, op='remove', labels=labels)": {
   "ClientId": "C.abad2ac29511a9ac",
   "Labels": [
    "WinBoxes"
   ],
   "Op": "remove"
  }
 }
]SELECT * FROM clients(search='label:*') ORDER BY client_id[]