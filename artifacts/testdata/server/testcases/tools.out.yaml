Query: SELECT inventory_add(tool='Autorun_amd64', url='https://storage.googleapis.com/go.velocidex.com/autorunsc.exe', hash='083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153', filename='autorunsc_x64.exe') FROM scope()
Output: [
 {
  "inventory_add(tool='Autorun_amd64', url='https://storage.googleapis.com/go.velocidex.com/autorunsc.exe', hash='083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153', filename='autorunsc_x64.exe')": {
   "name": "Autorun_amd64",
   "url": "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe",
   "github_project": "",
   "github_asset_regex": "",
   "serve_locally": false,
   "admin_override": true,
   "expected_hash": "",
   "version": "",
   "materialize": false,
   "artifact": "",
   "filestore_path": "",
   "serve_url": "",
   "serve_urls": [],
   "serve_path": "",
   "filename": "autorunsc_x64.exe",
   "hash": "083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153",
   "invalid_hash": "",
   "versions": []
  }
 }
]

Query: SELECT inventory_get(tool='Autorun_amd64') FROM scope()
Output: [
 {
  "inventory_get(tool='Autorun_amd64')": {
   "Tool_Autorun_amd64_HASH": "083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153",
   "Tool_Autorun_amd64_FILENAME": "autorunsc_x64.exe",
   "Tool_Autorun_amd64_URL": "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe",
   "Tool_Autorun_amd64_URLs": "[\"https://storage.googleapis.com/go.velocidex.com/autorunsc.exe\"]",
   "Definition": {
    "name": "Autorun_amd64",
    "url": "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe",
    "admin_override": true,
    "filestore_path": "c6bc3feacddc72332f5739fa1023515b6490daeec95711566601e01986eadfc1",
    "serve_url": "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe",
    "serve_urls": [
     "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe"
    ],
    "filename": "autorunsc_x64.exe",
    "hash": "083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153",
    "versions": [
     {
      "name": "Autorun_amd64",
      "url": "https://live.sysinternals.com/tools/autorunsc64.exe",
      "artifact": "Notebooks.Demo"
     },
     {
      "name": "Autorun_amd64",
      "url": "https://live.sysinternals.com/tools/autorunsc64.exe",
      "serve_locally": true,
      "artifact": "Windows.Sysinternals.Autoruns"
     }
    ]
   }
  }
 }
]

Query: SELECT inventory_add(tool='Autorun_amd64', serve_locally=TRUE, url='https://storage.googleapis.com/go.velocidex.com/autorunsc.exe', hash='083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153', filename='autorunsc_x64.exe') FROM scope()
Output: [
 {
  "inventory_add(tool='Autorun_amd64', serve_locally=TRUE, url='https://storage.googleapis.com/go.velocidex.com/autorunsc.exe', hash='083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153', filename='autorunsc_x64.exe')": {
   "name": "Autorun_amd64",
   "url": "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe",
   "github_project": "",
   "github_asset_regex": "",
   "serve_locally": true,
   "admin_override": true,
   "expected_hash": "",
   "version": "",
   "materialize": false,
   "artifact": "",
   "filestore_path": "",
   "serve_url": "",
   "serve_urls": [],
   "serve_path": "",
   "filename": "autorunsc_x64.exe",
   "hash": "083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153",
   "invalid_hash": "",
   "versions": []
  }
 }
]

Query: SELECT inventory_get(tool='Autorun_amd64') FROM scope()
Output: [
 {
  "inventory_get(tool='Autorun_amd64')": {
   "Tool_Autorun_amd64_HASH": "083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153",
   "Tool_Autorun_amd64_FILENAME": "autorunsc_x64.exe",
   "Tool_Autorun_amd64_URL": "https://www.velociraptor.server.com:8000/public/c6bc3feacddc72332f5739fa1023515b6490daeec95711566601e01986eadfc1",
   "Tool_Autorun_amd64_URLs": "[\"https://www.velociraptor.server.com:8000/public/c6bc3feacddc72332f5739fa1023515b6490daeec95711566601e01986eadfc1\"]",
   "Definition": {
    "name": "Autorun_amd64",
    "url": "https://storage.googleapis.com/go.velocidex.com/autorunsc.exe",
    "serve_locally": true,
    "admin_override": true,
    "filestore_path": "c6bc3feacddc72332f5739fa1023515b6490daeec95711566601e01986eadfc1",
    "serve_url": "https://www.velociraptor.server.com:8000/public/c6bc3feacddc72332f5739fa1023515b6490daeec95711566601e01986eadfc1",
    "serve_urls": [
     "https://www.velociraptor.server.com:8000/public/c6bc3feacddc72332f5739fa1023515b6490daeec95711566601e01986eadfc1"
    ],
    "filename": "autorunsc_x64.exe",
    "hash": "083d7eee4ed40a3e5a35675503b0b6be0cb627b4cb1009d185a558a805f64153",
    "versions": [
     {
      "name": "Autorun_amd64",
      "url": "https://live.sysinternals.com/tools/autorunsc64.exe",
      "artifact": "Notebooks.Demo"
     },
     {
      "name": "Autorun_amd64",
      "url": "https://live.sysinternals.com/tools/autorunsc64.exe",
      "serve_locally": true,
      "artifact": "Windows.Sysinternals.Autoruns"
     }
    ]
   }
  }
 }
]

## Upload a local file
Query: SELECT inventory_add(tool="FooBar", file=srcDir+"/artifacts/testdata/files/yara_test.txt") FROM scope()
Output: [
 {
  "inventory_add(tool=\"FooBar\", file=srcDir + \"/artifacts/testdata/files/yara_test.txt\")": {
   "name": "FooBar",
   "url": "",
   "github_project": "",
   "github_asset_regex": "",
   "serve_locally": true,
   "admin_override": true,
   "expected_hash": "",
   "version": "",
   "materialize": false,
   "artifact": "",
   "filestore_path": "77e71a25fc41db4cc20410a71b3d000b25d2bd0688f08b832e150e850078235c",
   "serve_url": "",
   "serve_urls": [],
   "serve_path": "",
   "filename": "yara_test.txt",
   "hash": "f03278c10a41adcc97f24a612a680e7aa43efb461b337fef3d2a3d47b51e77bb",
   "invalid_hash": "",
   "versions": []
  }
 }
]

Query: SELECT inventory_get(tool="FooBar") FROM scope()
Output: [
 {
  "inventory_get(tool=\"FooBar\")": {
   "Tool_FooBar_HASH": "f03278c10a41adcc97f24a612a680e7aa43efb461b337fef3d2a3d47b51e77bb",
   "Tool_FooBar_FILENAME": "yara_test.txt",
   "Tool_FooBar_URL": "https://www.velociraptor.server.com:8000/public/77e71a25fc41db4cc20410a71b3d000b25d2bd0688f08b832e150e850078235c",
   "Tool_FooBar_URLs": "[\"https://www.velociraptor.server.com:8000/public/77e71a25fc41db4cc20410a71b3d000b25d2bd0688f08b832e150e850078235c\"]",
   "Definition": {
    "name": "FooBar",
    "serve_locally": true,
    "admin_override": true,
    "filestore_path": "77e71a25fc41db4cc20410a71b3d000b25d2bd0688f08b832e150e850078235c",
    "serve_url": "https://www.velociraptor.server.com:8000/public/77e71a25fc41db4cc20410a71b3d000b25d2bd0688f08b832e150e850078235c",
    "serve_urls": [
     "https://www.velociraptor.server.com:8000/public/77e71a25fc41db4cc20410a71b3d000b25d2bd0688f08b832e150e850078235c"
    ],
    "filename": "yara_test.txt",
    "hash": "f03278c10a41adcc97f24a612a680e7aa43efb461b337fef3d2a3d47b51e77bb"
   }
  }
 }
]

