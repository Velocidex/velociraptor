name: Demo.Plugins.GUI
description: |
  A demo plugin showing some GUI features.

  This plugin is also used for tests.


parameters:
  - name: ChoiceSelector
    type: choices
    default: First Choice
    choices:
      - First Choice
      - Second Choice
      - Third Choice

  - name: Flag
    type: bool
    default: Y

  - name: Flag2
    type: bool
    default: Y

  - name: Flag3
    type: bool
    default: Y

  - name: OffFlag
    type: bool

  - name: StartDate
    type: timestamp

  - name: StartDate2
    type: timestamp

  - name: StartDate3
    type: timestamp

  - name: CSVData
    type: csv
    default: |
      Column1,Column2
      A,B
      C,D

  - name: CSVData2
    type: csv
    default: |
      Column1,Column2
      A,B
      C,D

  - name: JSONData
    type: json_array
    default: "[]"

  - name: JSONData2
    type: json_array
    default: |
      [{"foo": "bar"}]

sources:
  - query: |
      SELECT ChoiceSelector, Flag, Flag2, Flag3, OffFlag, StartDate, StartDate2, StartDate3,
             CSVData, CSVData2, JSONData, JSONData2
      FROM scope()

    notebook:
      - type: md
        template: |
          # GUI Notebook tests

          The following cells are testing the notebook in the flow. To
          run this test simply collect the `Demo.Plugins.GUI` artifact
          and check the output is correct.

          **Each of the below cells should have a H2 heading**

      - type: md
        template: |
          ## Code syntax highlighting for VQL

          ```vql
          SELECT * FROM info()
          ```

      - type: vql
        template: |
          /*
          ## A VQL cell with a heading.
          */
          SELECT * FROM info()

      - type: Markdown
        template: |
          ## A Line Chart

          The following should show a CPU load chart of the last 10 min.

          {{ define "Q" }}
            SELECT _ts, CPUPercent
            FROM source(
                  source="Prometheus",
                  artifact="Server.Monitor.Health",
                  start_time=now() - 10 * 60)
            LIMIT 100
          {{ end }}

          {{ Query "Q" | LineChart "xaxis_mode" "time" }}

      - type: vql
        template: |
          /*
          ## Adding timelines

          Add a timeline from this time series data
          */
          SELECT timestamp(epoch=_ts) AS Timestamp, CPUPercent
          FROM source(
            source="Prometheus",
            artifact="Server.Monitor.Health",
            start_time=now() - 10 * 60)

      - type: Markdown
        template: |
          ## This is an empty timeline - add the below column to it.

          {{ Timeline "Test" }}
